(function(){var g={}; var _ = _ || {}
var f=function(window){var bV=function(a){this.startTime=a.startTime;this.endTime=a.endTime;this.a=this.f=null;a=a.value;if(!_.N.R(a)){a:{var b=a.info;if(_.N.da(b)&&(b=b.toLowerCase().match(/lang:(\w+)/))&&b[1]){b=b[1].toLowerCase();break a}b=null}this.f=b;a=a.data;this.a=_.N.da(a)?a:null}},dV=function(a,b,c){this.m=a;this.l=b;this.j=c;this.a=new _.Wh;this.h=(a=_.uv(_.Wc))?new a(this.m.getConfiguration()):null;this.g=new _.K("clpp.hlssmpte.ImageCueHandler");this.f=null;cV(this)},cV=function(a){a.a.one(a.m,_.Ie,function(){return eV(a)})},
eV=function(a){var b=a.m.getSurface().getMedia();if(b)if(a.h){a.a.on(b.textTracks,_.Kc,function(d){return fV(a,d)});var c=Array.from(b.textTracks);c.filter(function(d){return d.kind===_.Qe}).forEach(function(d){fV(a,{track:d})});!gV(c)&&a.l&&(a.g.warn("The metadata track is not present. Changing an audio track in order to enforce the creation of the metadata track."),hV(a,b))}else a.g.warn("The clpp.ttml.TextParser class is not available. Please register the ttml component first.");else a.g.warn("A video element is not available. Skipping.")},
gV=function(a){return a.some(function(b){return b.kind===_.Qe})},hV=function(a,b){var c=a.m.getTrackManager(),d=c.oa(),e=c.getAudioTracks().find(function(g){return g!==d});if(e){var f=function(){return c.Fa(d)};a.a.on(b.textTracks,_.Kc,function(g){g.track.kind===_.Qe&&(a.a.off(b.textTracks,_.Kc,f),f())});c.Fa(e)}else a.g.warn("Can't enforce the creation of the metadata track if single audio track. Skipping.")},fV=function(a,b){var c=b.track;c.kind===_.Qe&&(a.g.info("The metadata track has been added."),
c.mode=_.we,a.a.on(c,_.Td,function(d){return iV(a,d)}))},iV=function(a,b){var c=jV(a);c&&Array.from(b.target.activeCues||[]).forEach(function(d){if(d!==a.f&&Number.isFinite(d.startTime)&&Number.isFinite(d.endTime)&&"org.id3"===d.type&&d.value&&"TXXX"===d.value.key){var e=new bV(d);if(e.f===c&&null!==e.a){a.f=d;d=a.h.parseMedia(_.T.$a(e.a),{periodStart:a.j,segmentStart:e.startTime,segmentEnd:e.endTime});var f=a.m.getTextDisplayer();f.remove(0,e.startTime);f.append(d.cues,d.styles)}}})},jV=function(a){return(a=
a.m.getTrackManager().ya())&&a.language&&a.language.toLowerCase()},kV=function(){this.a=null;this.f=!1},lV=function(){};dV.prototype.destroy=function(){this.a.release();this.f=null;return Promise.resolve()};_.x(kV,_.Gv);kV.prototype.onPlayerCreated=function(){};kV.prototype.onContentWillLoad=function(a){if(this.f=_.Fl()){var b=a.getConfiguration();b=_.N.cb(b.hlssmpte||{});_.N.gi(b.patchMetadataTrack)||(b.patchMetadataTrack=!1);_.N.ua(b.timestampOffset)||(b.timestampOffset=0);this.a=new dV(a,b.patchMetadataTrack,b.timestampOffset)}};kV.prototype.onPlayerWillDestroy=function(){var a=this;return _.I(function(b){if(1==b.a)return a.a?_.y(b,a.a.destroy(),3):b.F(0);a.a=null;_.B(b)})};kV.prototype.id=function(){return"hlssmpte"};
_.J("clpp.hlssmpte.HlsSmptePlugin",kV);kV.Id="hlssmpte";lV.prototype.create=function(){return new kV};_.gt(new lV);};
if(typeof(module)!="undefined"&&module.exports){var x=require("./cl.core.js");_ = x._;(f.call(g,this));module.exports=g;}
else if (typeof(define)!="undefined"&&define.amd) {define(["./cl.core"], function(c){_=c._;(f.call(g,this));return g;});}
else{_=this.clpp._;(f.call(g,this));}
})();