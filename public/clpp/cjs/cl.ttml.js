(function(){var g={}; var _ = _ || {}
var f=function(window){var Vx='application/mp4; codecs\x3d"stpp.ttml"',Wx='application/mp4; codecs\x3d"stpp.ttml.im1i"',Xx='application/mp4; codecs\x3d"stpp.ttml.im1t"',Yx="backgroundColor",Zx="direction",$x="displayAlign",ay="region",by="sans-serif",cy="textAlign",dy="textDecoration",ey="writingMode",fy=function(a,b,c){this.h=a;this.f=b;this.a=c},gy=function(a,b,c){fy.call(this,a,[],c);this.j=b||""},hy=function(a,b,c){fy.call(this,a,b,c)},iy=function(a,b,c){a=a.f;for(var d=a.length-1;0<=d;d--){var e=b.get(a[d]);if(c in
e.a)return e.getAttribute(c)}return null},qy=function(a,b){var c=null;if(jy.test(a)){c=jy.exec(a);var d=Number(c[1]),e=Number(c[2]),f=Number(c[3]),g=Number(c[4]);g+=(Number(c[5])||0)/b.f;f+=g/b.frameRate;c=f+60*e+3600*d}else ky.test(a)?c=ly(ky,a):my.test(a)?c=ly(my,a):ny.test(a)?(c=ny.exec(a),c=Number(c[1])/b.frameRate):oy.test(a)?(c=oy.exec(a),c=Number(c[1])/b.a):py.test(a)&&(c=ly(py,a));return c},ly=function(a,b){var c=a.exec(b);return null==c||""===c[0]?null:(Number(c[4])||0)/1E3+(Number(c[3])||
0)+60*(Number(c[2])||0)+3600*(Number(c[1])||0)},ry=function(a){return a.split(":").pop()},sy=function(a){return a.replace(/(\d*\.?\d+)c/g,"$1em")},uy=function(a,b){for(;ty.test(a);){var c=ty.exec(a)[0];a=a.replace(c,parseInt(c,10)/b+"em")}return a},vy=function(a){return a?a.replace(/(\d*\.?\d+)%/g,function(b,c){return c/100+"em"}):""},wy=function(a,b,c,d,e,f,g){fy.call(this,a,f,g);this.w=b;this.A=c;this.o=d;this.l=e;this.j=[]},xy=function(a,b,c){a=iy(a,b,cy);if(!a&&c&&(a=iy(c,b,cy),!a&&"rltb"===iy(c,
b,ey)))return _.Pf;switch(a){case _.sd:return _.Ci;case _.Pf:case _.le:return _.Pf;default:return _.ye}},yy=function(a,b,c){if(_.R.Me(a.w))return document.createTextNode(_.R.vg(a.w||""));if(a.A)return _.tq("br");for(var d=_.tq("span"),e=_.w(a.f),f=e.next();!f.done;f=e.next())_.uq(d,f.value);a=_.w(a.j);for(e=a.next();!e.done;e=a.next())d.appendChild(yy(c.get(e.value),b,c));return d},zy=function(a,b,c,d){this.frameRate=Number(a)||30;this.f=Number(b)||1;this.a=Number(d);0===this.a&&(this.a=a?this.frameRate*
this.f:1);c&&(a=/^(\d+) (\d+)$/g.exec(c))&&(this.frameRate*=Number(a[1])/Number(a[2]))},Ay=function(a,b,c){fy.call(this,a,b,c)},Dy=function(a,b,c,d){var e=By.exec(a);a=Cy.exec(a);return typeof b===_.k&&0<b&&a?100*Number(a[c])/b:e?Number(e[c]):a?Number(a[c]):d},Ey=function(a,b){return typeof b===_.k&&0<b?_.Ii:Cy.test(a)?0:_.Ii},Fy=function(a,b){fy.call(this,"root-container",[],b);this.j=a},Gy=function(a,b,c){return typeof a===_.k?a:typeof b===_.k?b:c},Hy=function(a,b){var c=a.getAttribute("extent");
return(c=Cy.exec(c))?Number(c[b]):null},Jy=function(a){a=a.getAttribute("cellResolution");return(a=Iy.exec(a))?Number(a[2]):null},Ky=function(a,b,c){fy.call(this,a,b,c)},Ly=function(a){this.B=a;this.w=this.l=null;this.A=0;this.h=new Map;this.a=new Map;this.j=new Map;this.f=new Map;this.o=[]},Ny=function(a){return My.some(function(b){return b in a.attributes})},Oy=function(a,b){if(0===b.length)return[];for(var c=[],d=_.w(b),e=d.next();!e.done;e=d.next())e=e.value,a.a.has(e)&&c.push.apply(c,_.ah(Oy(a,
a.a.get(e).f)).concat([e]));return c},Qy=function(){return"inline-"+Py++},Ry=function(a){return a.o.map(function(b){return b.build(a.l,a.w,a.A,a.h,a.a,a.j,a.f)}).filter(function(b){return null!=b})},Sy=function(a){this.a=a.firstChild;this.f=new Set},Ty=function(a,b,c,d,e,f){this.h=a;this.a=b;this.j=c;this.l=d;this.f=e;this.attributes=f},Uy=function(a){return ry(a.h.nodeName)},Vy=function(){this.a=new Map},Xy=function(a,b){if(a.a.has(b))return a.a.get(b);var c=null,d=null,e=[],f=[],g={},h=b.parentNode;
if(h&&a.a.has(h)){var l=a.a.get(h);e=_.ah(l.l).concat();-1===["#text","span","br"].indexOf(b.nodeName)&&(c=l.a,d=l.j,f=_.ah(l.f).concat(),g={},Wy.forEach(function(n){n in l.attributes&&(g[n]=l.attributes[n])}))}if(b.nodeType===b.ELEMENT_NODE){b.hasAttribute(ay)&&(c=b.getAttribute(ay));b.hasAttribute(_.hg)&&f.push.apply(f,_.ah(b.getAttribute(_.hg).split(" ")));d=Array.from(b.attributes).map(function(n){return n.name});d=_.w(d);for(h=d.next();!h.done;h=d.next()){h=h.value;var m=ry(h);g[m]=b.getAttribute(h)}d=
g.backgroundImage}c=new Ty(b,c,d,e,f,g);a.a.set(b,c);return c},Yy=function(a){this.a=a;this.f=new DOMParser},Zy=function(a){this.f=a},$y=function(a){return String(Math.floor(a/3600)).padStart(2,"0")+":"+String(Math.floor(a/60%60)).padStart(2,"0")+":"+String(Math.floor(a%60)).padStart(2,"0")+"."+String(Math.floor(1E3*a%1E3)).padStart(3,"0")},az=function(){},bz=function(a){this.a=new Yy(a);this.g=new _.K("clpp.ttml.Mp4TtmlParser")},cz=function(){this.j=new az};fy.prototype.getId=function(){return this.h};
fy.prototype.getAttribute=function(a){return this.a[a]};_.x(gy,fy);_.x(hy,fy);var jy=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,ky=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,my=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d+)$/,ny=/^(\d*(?:\.\d*)?)f$/,oy=/^(\d*(?:\.\d*)?)t$/,py=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,By=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,Cy=/^(\d+)px (\d+)px$/,Iy=/^(\d+) (\d+)$/,ty=/(\d+)px/,dz=/^(\d+px|\d+em|\d*\.?\d+c)$/,My=[Yx,"color",Zx,$x,"fontFamily","fontSize","fontStyle","fontWeight",
"lineHeight","opacity","padding",cy,dy,"textOutline",ey,"zIndex"],Wy=["begin",_.le];_.x(wy,hy);
wy.prototype.build=function(a,b,c,d,e,f,g){var h=qy(this.a.begin,b);b=qy(this.a.end,b);if(null===h||null===b)return null;h+=c;b+=c;c=_.tq(_.Wd);for(var l=_.w(this.j),m=l.next();!m.done;m=l.next())c.appendChild(yy(g.get(m.value),e,g));g=new _.Hi(h,b,c.innerHTML.trim(),_.pg);g.cssClassList=_.ah(this.f).concat();g.textAlign=xy(this,e,null);g.writingMode=_.Di;g.line=-1;g.lineInterpretation=_.Ei;g.lineAlign=_.Fi;g.containerRows=Gy(null,Jy(a),15);if(this.o&&(f=f.get(this.o))){g.region=f.build(a,e);g.textAlign=
xy(this,e,f);a:switch(iy(f,e,ey)){case "tb":case "tblr":a=_.Ag;break a;case "tbrl":a=_.Bg;break a;default:a=_.Di}g.writingMode=a;a:switch(iy(f,e,$x)){case _.sd:a=50;break a;case "after":a=-1;break a;default:a=0}g.line=a;a:switch(iy(f,e,$x)){case _.sd:a=1;break a;default:a=_.Ei}g.lineInterpretation=a;a:switch(iy(f,e,$x)){case _.sd:e=_.sd;break a;default:e=_.Fi}g.lineAlign=e}this.l&&(a=d.get(this.l))&&(d=a.getAttribute("encoding"),e=a.getAttribute("imageType")||a.getAttribute("imagetype"),a=a.j.trim(),
g.backgroundImage=("PNG"===e&&"Base64"===d&&0<a.length?"data:image/png;base64,"+a:null)||"");return g};_.x(Ay,hy);
Ay.prototype.build=function(a,b){var c=new _.Ki;c.id=this.getId();var d=Gy(a.j.containerWidth,Hy(a,1),720),e=Gy(a.j.containerHeight,Hy(a,2),480);a:switch(iy(this,b,$x)){case "after":var f="flex-start";break a;case _.sd:f=_.sd;break a;default:f="flex-end"}c.displayAlign=f;a:switch(iy(this,b,ey)){case "tb":case "tblr":f="row-reverse";break a;case "tbrl":f="row";break a;default:f=_.Hd}c.writingMode=f;f=this.getAttribute("extent")||iy(this,b,"extent");c.width=Dy(f,d,1,100);c.widthUnits=Ey(f,d);c.height=
Dy(f,e,2,100);c.heightUnits=Ey(f,e);f=this.getAttribute("origin")||iy(this,b,"origin");c.viewportAnchorX=Dy(f,d,1,0);c.viewportAnchorY=Dy(f,e,2,0);c.viewportAnchorUnits=Ey(f,d);c.cssClassList=_.ah(this.f).concat();return c};_.x(Fy,fy);_.x(Ky,fy);
Ky.prototype.build=function(a){var b=null;var c=Jy(a);c&&(b=Gy(a.j.containerHeight,Hy(a,2),480)/c);b=Gy(a.j.fontSizeRadix,b,16);a=[];c="::ttml ."+this.h+", ::ttml ."+this.h+" * {";for(var d=_.w(ez.entries()),e=d.next();!e.done;e=d.next()){var f=_.w(e.value);e=f.next().value;f=f.next().value;e in this.a&&(c+=f+":"+sy(this.a[e])+";")}a:{if("unicodeBidi"in this.a){d=this.a.unicodeBidi;e="";switch(d){case "normal":case "embed":e=d;break;case "bidiOverride":e="bidi-override"}if(0<e.length){d="unicode-bidi:"+
e+";";break a}}d=""}c+=d;a:{if("textOutline"in this.a){d=this.a.textOutline.split(" ");e="black";f=".4em";var g=d[0]&&d[0].trim(),h=d[1]&&d[1].trim(),l=d[2]&&d[2].trim();3===d.length&&!dz.test(g)&&dz.test(h)&&dz.test(l)?(e=g,f=h):2===d.length&&!dz.test(g)&&dz.test(h)?(e=g,f=h):2===d.length&&dz.test(g)&&dz.test(h)&&(f=g);if(""!==f){f=sy(f);d="text-shadow:0 0 "+(f+" "+e+",0 0 ")+(f+" "+e+",0 0 ")+(f+" "+e+";");break a}}d=""}c+=d;"textShadow"in this.a?(d=vy(this.a.textShadow),d=sy(d),d="text-shadow:"+
d+";"):d="";c=c+d+("fontFamily"in this.a?"font-family:"+this.a.fontFamily.replace("monospaceSansSerif","monospace").replace("monospaceSerif","monospace").replace("proportionalSansSerif",by).replace("proportionalSerif",by).replace("sansSerif",by).replace("default",by)+";":"");a:{if(dy in this.a){d=[];e=_.w(this.a.textDecoration.split(" "));for(f=e.next();!f.done;f=e.next())switch(f=f.value,f){case "underline":case "overline":d.push(f);break;case "lineThrough":d.push("line-through")}if(0<d.length){d=
"text-decoration:"+d.join(" ")+";";break a}}d=""}e="padding"in this.a?"border: solid transparent;border-width:"+sy(this.a.padding)+";":"";c=c+d+e;"lineHeight"in this.a?(d="",e=this.a.lineHeight,e=sy(e),e=uy(e,b),d=d+"line-height:"+e+";"):d="";a.push(c+d+"}");a:{if("fontSize"in this.a&&(c=this.a.fontSize.split(" "),d=null,1===c.length&&(d=c[0]),2===c.length&&(d=c[1]),d)){d=d.trim();d=sy(d);d=uy(d,b);b="font-size:"+d+";";break a}b=null}b&&(c="::ttml ."+this.h+" .clpp-text-wrapper {",a.push(c+b+"}"),
c="::ttml .clpp-text-wrapper__"+this.h+" {",a.push(c+b+"}"));return a};var ez=new Map([[Yx,"background-color"],["color","color"],[Zx,Zx],["fontStyle","font-style"],["fontWeight","font-weight"],["opacity","opacity"],["zIndex","z-index"]]);var Py=0;Sy.prototype.Rd=function(){return!!this.a};Sy.prototype.next=function(){if(!this.a)return null;var a=this.a;do this.f.add(a),a.nodeType!==Node.TEXT_NODE&&!fz.has(ry(a.nodeName))||gz.has(ry(a.nodeName))||!a.firstChild||this.f.has(a.firstChild)?a.nextSibling?a=a.nextSibling:a=a.parentNode:a=a.firstChild;while(a&&(this.f.has(a)||a.nodeType!==Node.TEXT_NODE&&!fz.has(ry(a.nodeName))));var b=this.a;this.a=a;return b};
var fz=new Set(["tt","head","layout",_.Ne,_.ve,ay,"styling",_.hg,"body",_.Wd,"p","span","br"]),gz=new Set([_.hg,_.ve]);Ty.prototype.getId=function(){return this.attributes.id};Yy.prototype.parseInit=function(){};
Yy.prototype.parseMedia=function(a,b,c){c&&c.length||(c=[a.byteLength]);var d=_.M.bb(this.a.ttml||{}),e=_.zj(a,0,c[0]);e=_.R.aa(e);if(""===e)return{cues:[],styles:[]};var f=null;try{f=this.f.parseFromString(e,_.mg)}catch(n){throw new _.N(_.P,2,2005,"Failed to parse TTML.");}d=new Ly(d);e=new Vy;f=new Sy(f);b=b.periodStart;typeof b===_.k&&(d.A=b);b=c[0];for(var g=1;g<c.length;++g){var h=c[g],l=_.zj(a,b,h);l=_.Jj(l);var m="urn:mpeg:14496-30:subs:"+g;d.h.set(m,new gy(m,l,{imageType:"PNG",encoding:"Base64"}));
b+=h}for(;f.Rd();)a=f.next(),a=Xy(e,a),"tt"===Uy(a)&&(d.l=new Fy(d.B,Object.assign({},a.attributes))),"tt"===Uy(a)&&(d.w=new zy(a.attributes.frameRate,a.attributes.subFrameRate,a.attributes.frameRateMultiplier,a.attributes.tickRate)),Uy(a)!==_.ve||a.attributes.begin||a.attributes.end||(c="#"+a.getId(),d.h.set(c,new gy(c,a.h.textContent,a.attributes))),Uy(a)===_.ve&&a.attributes.begin&&a.attributes.end?(c="#"+Qy(),b=new gy(c,a.h.textContent,a.attributes),d.h.set(c,b),c=b):c=null,c&&(a.j=c.getId()),
Uy(a)===_.hg&&(c=a.getId()||Qy(),b=new Ky(c,a.f,Object.assign({},a.attributes)),d.a.set(c,b),a.a&&d.j.get(a.a).f.push(c)),Uy(a)!==_.hg&&Ny(a)?(c=Qy(),b=new Ky(c,[],Object.assign({},a.attributes)),d.a.set(c,b),c=b):c=null,c&&a.f.push(c.getId()),Uy(a)!==_.Wd||!a.attributes.extent&&!a.attributes.origin?c=null:(c=Qy(),b=new Ay(c,Oy(d,a.f),Object.assign({},a.attributes)),d.j.set(c,b),c=b),c&&(a.a=c.getId()),Uy(a)!==ay?c=null:(c=a.getId(),b=new Ay(c,Oy(d,a.f),Object.assign({},a.attributes)),d.j.set(c,b),
c=b),c&&(a.a=c.getId()),c=a.l,-1===["#text","span","br"].indexOf(Uy(a))||0===c.length?c=null:(g=c[c.length-1],d.f.has(g)?(c=Qy(),b=new wy(c,"#text"===a.h.nodeName?a.h.textContent:null,"br"===Uy(a),a.a,a.j,Oy(d,a.f),a.attributes),d.f.set(c,b),(g=d.f.get(g))&&g.j.push(c),c=b):c=null),c&&a.l.push(c.getId()),"p"===Uy(a)||a.j?(c=Qy(),b=new wy(c,null,!1,a.a,a.j,Oy(d,a.f),a.attributes),d.f.set(c,b),d.o.push(b),c=b):c=null,c&&a.l.push(c.getId());e=Ry(d);f=[];a=_.w(d.a.values());for(c=a.next();!c.done;c=a.next())f.push.apply(f,
_.ah(c.value.build(d.l)));return{cues:e,styles:f}};Zy.prototype.a=function(a){a=(new Yy(this.f)).parseMedia(a,{periodStart:0,segmentStart:null,segmentEnd:0}).cues;var b="WEBVTT\n\n";a=_.w(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=$y(c.startTime)+" --\x3e "+$y(c.endTime),e=[];switch(c.textAlign){case _.ye:e.push("align:left");break;case _.Pf:e.push("align:right");break;case _.Ci:e.push("align:middle");break;case _.ye:e.push("align:start");break;case _.Pf:e.push("align:end")}switch(c.writingMode){case _.Ag:e.push("vertical:lr");break;
case _.Bg:e.push("vertical:rl")}b+=d+(e.length?" "+e.join(" "):"")+"\n";b+=c.payload+"\n\n"}return _.R.$a(b)};az.prototype.probe=function(a,b){return a===_.Xc&&b===_.lg};az.prototype.create=function(a){return new Zy(a)};bz.prototype.parseInit=function(a){var b=!1;(new _.gn).M(_.Qe,_.hn).M(_.og,_.hn).M(_.Le,_.hn).M(_.Pe,_.hn).M(_.eg,_.hn).Y(_.gg,_.jn).M("stpp",function(c){b=!0;c.parser.stop()}).parse(a);if(!b)throw new _.N(_.P,2,2007);};
bz.prototype.parseMedia=function(a,b){var c=this,d=!1,e=[],f=[],g=[];(new _.gn).M("moof",_.hn).M("traf",_.hn).Y("subs",function(h){for(var l=_.W(h.reader),m=0;m<l;++m){h.reader.skip(4);for(var n=_.bn(h.reader),p=0;p<n;++p){var q=1===h.version?_.W(h.reader):_.bn(h.reader);g.push(q);h.reader.skip(6)}}}).M(_.Je,_.kn(function(h){d=!0;h=c.a.parseMedia(h,b,g);e=e.concat(h.cues);f=f.concat(h.styles)})).parse(a);d||this.g.warn("Couldn't find the mdat box");return{cues:e,styles:f}};_.x(cz,_.tt);cz.prototype.f=function(){_.cv(_.Xc,Yy);_.cv(_.Vc,bz);_.cv(Vx,bz);_.cv(Xx,bz);_.cv(Wx,bz);_.$k.push(this.j)};cz.prototype.a=function(){_.ev(_.Xc);_.ev(_.Vc);_.ev(Vx);_.ev(Xx);_.ev(Wx);_.bl(this.j)};cz.prototype.id=function(){return"subtitles-ttml"};_.J("clpp.ttml.TtmlComponent",cz);};
if(typeof(module)!="undefined"&&module.exports){var x=require("./cl.core.js");_ = x._;(f.call(g,this));module.exports=g;}
else if (typeof(define)!="undefined"&&define.amd) {define(["./cl.core"], function(c){_=c._;(f.call(g,this));return g;});}
else{_=this.clpp._;(f.call(g,this));}
})();