(function(){var g={}; var _ = _ || {}
var f=function(window){var my='application/mp4; codecs\x3d"stpp.ttml"',ny='application/mp4; codecs\x3d"stpp.ttml.im1i"',oy='application/mp4; codecs\x3d"stpp.ttml.im1t"',py="backgroundColor",qy="direction",ry="displayAlign",sy="region",ty="sans-serif",uy="textAlign",vy="textDecoration",wy="writingMode",xy=function(a,b,c){this.h=a;this.f=b;this.a=c},yy=function(a,b,c){xy.call(this,a,[],c);this.j=b||""},zy=function(a,b,c){xy.call(this,a,b,c)},Ay=function(a,b,c){a=a.f;for(var d=a.length-1;0<=d;d--){var e=b.get(a[d]);if(e.hasAttribute(c))return e.getAttribute(c)}return null},
Iy=function(a,b){var c=null;if(By.test(a)){c=By.exec(a);var d=Number(c[1]),e=Number(c[2]),f=Number(c[3]),g=Number(c[4]);g+=(Number(c[5])||0)/b.f;f+=g/b.frameRate;c=f+60*e+3600*d}else Cy.test(a)?c=Dy(Cy,a):Ey.test(a)?c=Dy(Ey,a):Fy.test(a)?(c=Fy.exec(a),c=Number(c[1])/b.frameRate):Gy.test(a)?(c=Gy.exec(a),c=Number(c[1])/b.a):Hy.test(a)&&(c=Dy(Hy,a));return c},Dy=function(a,b){var c=a.exec(b);return null==c||""===c[0]?null:(Number(c[4])||0)/1E3+(Number(c[3])||0)+60*(Number(c[2])||0)+3600*(Number(c[1])||
0)},Jy=function(a){return a.split(":").pop()},Ky=function(a){return a.replace(/(\d*\.?\d+)c/g,"$1em")},My=function(a,b){for(;Ly.test(a);){var c=Ly.exec(a)[0];a=a.replace(c,parseInt(c,10)/b+"em")}return a},Ny=function(a){return a?a.replace(/(\d*\.?\d+)%/g,function(b,c){return c/100+"em"}):""},Oy=function(a,b,c,d,e,f,g){xy.call(this,a,f,g);this.w=b;this.A=c;this.o=d;this.l=e;this.j=[]},Py=function(a,b,c){a=Ay(a,b,uy);if(!a&&c&&(a=Ay(c,b,uy),!a&&"rltb"===Ay(c,b,wy)))return _.Sf;switch(a){case _.rd:return _.Gi;
case _.Sf:case _.oe:return _.Sf;default:return _.Be}},Qy=function(a,b,c){if(_.T.Xe(a.w))return document.createTextNode(_.T.Eg(a.w||""));if(a.A)return _.Iq("br");for(var d=_.Iq("span"),e=_.w(a.f),f=e.next();!f.done;f=e.next())_.Jq(d,f.value);a=_.w(a.j);for(e=a.next();!e.done;e=a.next())d.appendChild(Qy(c.get(e.value),b,c));return d},Ry=function(a,b,c,d){this.frameRate=Number(a)||30;this.f=Number(b)||1;this.a=Number(d);0===this.a&&(this.a=a?this.frameRate*this.f:1);c&&(a=/^(\d+) (\d+)$/g.exec(c))&&
(this.frameRate*=Number(a[1])/Number(a[2]))},Sy=function(a,b,c){xy.call(this,a,b,c)},Vy=function(a,b,c,d){var e=Ty.exec(a);a=Uy.exec(a);return typeof b===_.k&&0<b&&a?100*Number(a[c])/b:e?Number(e[c]):a?Number(a[c]):d},Wy=function(a,b){return typeof b===_.k&&0<b?_.Mi:Uy.test(a)?0:_.Mi},Xy=function(a,b){xy.call(this,"root-container",[],b);this.j=a},Yy=function(a,b,c){return typeof a===_.k?a:typeof b===_.k?b:c},Zy=function(a,b){var c=a.getAttribute("extent");return(c=Uy.exec(c))?Number(c[b]):null},az=
function(a){a=a.getAttribute("cellResolution");return(a=$y.exec(a))?Number(a[2]):null},bz=function(a,b,c){xy.call(this,a,b,c)},cz=function(a){this.B=a;this.w=this.l=null;this.A=0;this.h=new Map;this.a=new Map;this.j=new Map;this.f=new Map;this.o=[]},ez=function(a){return dz.some(function(b){return b in a.attributes})},fz=function(a,b){if(0===b.length)return[];for(var c=[],d=_.w(b),e=d.next();!e.done;e=d.next())e=e.value,a.a.has(e)&&c.push.apply(c,_.eh(fz(a,a.a.get(e).f)).concat([e]));return c},hz=
function(){return"inline-"+gz++},iz=function(a){return a.o.map(function(b){return b.build(a.l,a.w,a.A,a.h,a.a,a.j,a.f)}).filter(function(b){return null!=b})},jz=function(a){this.a=a.firstChild;this.f=new Set},kz=function(a,b,c,d,e,f){this.h=a;this.a=b;this.j=c;this.l=d;this.f=e;this.attributes=f},lz=function(a){return Jy(a.h.nodeName)},mz=function(){this.a=new Map},oz=function(a,b){if(a.a.has(b))return a.a.get(b);var c=null,d=null,e=[],f=[],g={},h=b.parentNode;if(h&&a.a.has(h)){var l=a.a.get(h);e=
_.eh(l.l).concat();-1===["#text","span","br"].indexOf(b.nodeName)&&(c=l.a,d=l.j,f=_.eh(l.f).concat(),g={},nz.forEach(function(n){n in l.attributes&&(g[n]=l.attributes[n])}))}if(b.nodeType===b.ELEMENT_NODE){b.hasAttribute(sy)&&(c=b.getAttribute(sy));b.hasAttribute(_.kg)&&f.push.apply(f,_.eh(b.getAttribute(_.kg).split(" ")));d=Array.from(b.attributes).map(function(n){return n.name});d=_.w(d);for(h=d.next();!h.done;h=d.next()){h=h.value;var m=Jy(h);g[m]=b.getAttribute(h)}d=g.backgroundImage}c=new kz(b,
c,d,e,f,g);a.a.set(b,c);return c},pz=function(a){this.a=a;this.f=new DOMParser},qz=function(a){this.f=a},rz=function(a){return String(Math.floor(a/3600)).padStart(2,"0")+":"+String(Math.floor(a/60%60)).padStart(2,"0")+":"+String(Math.floor(a%60)).padStart(2,"0")+"."+String(Math.floor(1E3*a%1E3)).padStart(3,"0")},sz=function(){},tz=function(a){this.a=new pz(a);this.g=new _.K("clpp.ttml.Mp4TtmlParser")},uz=function(){this.j=new sz};xy.prototype.getId=function(){return this.h};
xy.prototype.hasAttribute=function(a){return a in this.a};xy.prototype.getAttribute=function(a){return this.a[a]};_.x(yy,xy);_.x(zy,xy);var By=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Cy=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Ey=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d+)$/,Fy=/^(\d*(?:\.\d*)?)f$/,Gy=/^(\d*(?:\.\d*)?)t$/,Hy=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,Ty=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,Uy=/^(\d+)px (\d+)px$/,$y=/^(\d+) (\d+)$/,Ly=/(\d+)px/,vz=/^(\d+px|\d+em|\d*\.?\d+c)$/,dz=[py,"color",qy,ry,"fontFamily","fontSize","fontStyle","fontWeight",
"lineHeight","opacity","padding",uy,vy,"textOutline",wy,"zIndex"],nz=["begin",_.oe];_.x(Oy,zy);
Oy.prototype.build=function(a,b,c,d,e,f,g){var h=Iy(this.a.begin,b);b=Iy(this.a.end,b);if(null===h||null===b)return null;h+=c;b+=c;c=_.Iq(_.Xd);for(var l=_.w(this.j),m=l.next();!m.done;m=l.next())c.appendChild(Qy(g.get(m.value),e,g));g=new _.Li(h,b,c.innerHTML.trim(),_.sg);g.cssClassList=_.eh(this.f).concat();g.textAlign=Py(this,e,null);g.writingMode=_.Hi;g.line=-1;g.lineInterpretation=_.Ii;g.lineAlign=_.Ji;g.containerRows=Yy(null,az(a),15);if(this.o&&(f=f.get(this.o))){g.region=f.build(a,e);g.textAlign=
Py(this,e,f);a:switch(Ay(f,e,wy)){case "tb":case "tblr":a=_.Eg;break a;case "tbrl":a=_.Hg;break a;default:a=_.Hi}g.writingMode=a;a:switch(Ay(f,e,ry)){case _.rd:a=50;break a;case "after":a=-1;break a;default:a=0}g.line=a;a:switch(Ay(f,e,ry)){case _.rd:a=1;break a;default:a=_.Ii}g.lineInterpretation=a;a:switch(Ay(f,e,ry)){case _.rd:e=_.rd;break a;default:e=_.Ji}g.lineAlign=e}this.l&&(a=d.get(this.l))&&(d=a.getAttribute("encoding"),e=a.getAttribute("imageType")||a.getAttribute("imagetype"),a=a.j.trim(),
g.backgroundImage=("PNG"===e&&"Base64"===d&&0<a.length?"data:image/png;base64,"+a:null)||"");return g};_.x(Sy,zy);
Sy.prototype.build=function(a,b){var c=new _.Oi;c.id=this.getId();var d=Yy(a.j.containerWidth,Zy(a,1),720),e=Yy(a.j.containerHeight,Zy(a,2),480);a:switch(Ay(this,b,ry)){case "after":var f="flex-start";break a;case _.rd:f=_.rd;break a;default:f="flex-end"}c.displayAlign=f;a:switch(Ay(this,b,wy)){case "tb":case "tblr":f="row-reverse";break a;case "tbrl":f="row";break a;default:f=_.Gd}c.writingMode=f;f=this.getAttribute("extent")||Ay(this,b,"extent");c.width=Vy(f,d,1,100);c.widthUnits=Wy(f,d);c.height=
Vy(f,e,2,100);c.heightUnits=Wy(f,e);f=this.getAttribute("origin")||Ay(this,b,"origin");c.viewportAnchorX=Vy(f,d,1,0);c.viewportAnchorY=Vy(f,e,2,0);c.viewportAnchorUnits=Wy(f,d);c.cssClassList=_.eh(this.f).concat();return c};_.x(Xy,xy);_.x(bz,xy);
bz.prototype.build=function(a){var b=null;var c=az(a);c&&(b=Yy(a.j.containerHeight,Zy(a,2),480)/c);b=Yy(a.j.fontSizeRadix,b,16);a=[];c="::ttml ."+this.h+", ::ttml ."+this.h+" * {";for(var d=_.w(wz.entries()),e=d.next();!e.done;e=d.next()){var f=_.w(e.value);e=f.next().value;f=f.next().value;e in this.a&&(c+=f+":"+Ky(this.a[e])+";")}a:{if("unicodeBidi"in this.a){d=this.a.unicodeBidi;e="";switch(d){case "normal":case "embed":e=d;break;case "bidiOverride":e="bidi-override"}if(0<e.length){d="unicode-bidi:"+
e+";";break a}}d=""}c+=d;a:{if("textOutline"in this.a){d=this.a.textOutline.split(" ");e="black";f=".4em";var g=d[0]&&d[0].trim(),h=d[1]&&d[1].trim(),l=d[2]&&d[2].trim();3===d.length&&!vz.test(g)&&vz.test(h)&&vz.test(l)?(e=g,f=h):2===d.length&&!vz.test(g)&&vz.test(h)?(e=g,f=h):2===d.length&&vz.test(g)&&vz.test(h)&&(f=g);if(""!==f){f=Ky(f);d="text-shadow:0 0 "+(f+" "+e+",0 0 ")+(f+" "+e+",0 0 ")+(f+" "+e+";");break a}}d=""}c+=d;"textShadow"in this.a?(d=Ny(this.a.textShadow),d=Ky(d),d="text-shadow:"+
d+";"):d="";c=c+d+("fontFamily"in this.a?"font-family:"+this.a.fontFamily.replace("monospaceSansSerif","monospace").replace("monospaceSerif","monospace").replace("proportionalSansSerif",ty).replace("proportionalSerif",ty).replace("sansSerif",ty).replace("default",ty)+";":"");a:{if(vy in this.a){d=[];e=_.w(this.a.textDecoration.split(" "));for(f=e.next();!f.done;f=e.next())switch(f=f.value,f){case "underline":case "overline":d.push(f);break;case "lineThrough":d.push("line-through")}if(0<d.length){d=
"text-decoration:"+d.join(" ")+";";break a}}d=""}e="padding"in this.a?"border: solid transparent;border-width:"+Ky(this.a.padding)+";":"";c=c+d+e;"lineHeight"in this.a?(d="",e=this.a.lineHeight,e=Ky(e),e=My(e,b),d=d+"line-height:"+e+";"):d="";a.push(c+d+"}");a:{if("fontSize"in this.a&&(c=this.a.fontSize.split(" "),d=null,1===c.length&&(d=c[0]),2===c.length&&(d=c[1]),d)){d=d.trim();d=Ky(d);d=My(d,b);b="font-size:"+d+";";break a}b=null}b&&(c="::ttml ."+this.h+" .clpp-text-wrapper {",a.push(c+b+"}"),
c="::ttml .clpp-text-wrapper__"+this.h+" {",a.push(c+b+"}"));return a};var wz=new Map([[py,"background-color"],["color","color"],[qy,qy],["fontStyle","font-style"],["fontWeight","font-weight"],["opacity","opacity"],["zIndex","z-index"]]);var gz=0;jz.prototype.$d=function(){return!!this.a};jz.prototype.next=function(){if(!this.a)return null;var a=this.a;do this.f.add(a),a.nodeType!==Node.TEXT_NODE&&!xz.has(Jy(a.nodeName))||yz.has(Jy(a.nodeName))||!a.firstChild||this.f.has(a.firstChild)?a.nextSibling?a=a.nextSibling:a=a.parentNode:a=a.firstChild;while(a&&(this.f.has(a)||a.nodeType!==Node.TEXT_NODE&&!xz.has(Jy(a.nodeName))));var b=this.a;this.a=a;return b};
var xz=new Set(["tt","head","layout",_.Qe,_.ye,sy,"styling",_.kg,"body",_.Xd,"p","span","br"]),yz=new Set([_.kg,_.ye]);kz.prototype.getId=function(){return this.attributes.id};pz.prototype.parseInit=function(){};
pz.prototype.parseMedia=function(a,b,c){c&&c.length||(c=[a.byteLength]);var d=_.N.cb(this.a.ttml||{}),e=_.Fj(a,0,c[0]);e=_.T.$(e);if(""===e)return{cues:[],styles:[]};var f=null;try{f=this.f.parseFromString(e,_.pg)}catch(n){throw new _.O(_.P,2,2005,"Failed to parse TTML.");}d=new cz(d);e=new mz;f=new jz(f);b=b.periodStart;typeof b===_.k&&(d.A=b);b=c[0];for(var g=1;g<c.length;++g){var h=c[g],l=_.Fj(a,b,h);l=_.Pj(l);var m="urn:mpeg:14496-30:subs:"+g;d.h.set(m,new yy(m,l,{imageType:"PNG",encoding:"Base64"}));
b+=h}for(;f.$d();)a=f.next(),a=oz(e,a),"tt"===lz(a)&&(d.l=new Xy(d.B,Object.assign({},a.attributes))),"tt"===lz(a)&&(d.w=new Ry(a.attributes.frameRate,a.attributes.subFrameRate,a.attributes.frameRateMultiplier,a.attributes.tickRate)),lz(a)!==_.ye||a.attributes.begin||a.attributes.end||(c="#"+a.getId(),d.h.set(c,new yy(c,a.h.textContent,a.attributes))),lz(a)===_.ye&&a.attributes.begin&&a.attributes.end?(c="#"+hz(),b=new yy(c,a.h.textContent,a.attributes),d.h.set(c,b),c=b):c=null,c&&(a.j=c.getId()),
lz(a)===_.kg&&(c=a.getId()||hz(),b=new bz(c,a.f,Object.assign({},a.attributes)),d.a.set(c,b),a.a&&d.j.get(a.a).f.push(c)),lz(a)!==_.kg&&ez(a)?(c=hz(),b=new bz(c,[],Object.assign({},a.attributes)),d.a.set(c,b),c=b):c=null,c&&a.f.push(c.getId()),lz(a)!==_.Xd||!a.attributes.extent&&!a.attributes.origin?c=null:(c=hz(),b=new Sy(c,fz(d,a.f),Object.assign({},a.attributes)),d.j.set(c,b),c=b),c&&(a.a=c.getId()),lz(a)!==sy?c=null:(c=a.getId(),b=new Sy(c,fz(d,a.f),Object.assign({},a.attributes)),d.j.set(c,b),
c=b),c&&(a.a=c.getId()),c=a.l,-1===["#text","span","br"].indexOf(lz(a))||0===c.length?c=null:(g=c[c.length-1],d.f.has(g)?(c=hz(),b=new Oy(c,"#text"===a.h.nodeName?a.h.textContent:null,"br"===lz(a),a.a,a.j,fz(d,a.f),a.attributes),d.f.set(c,b),(g=d.f.get(g))&&g.j.push(c),c=b):c=null),c&&a.l.push(c.getId()),"p"===lz(a)||a.j?(c=hz(),b=new Oy(c,null,!1,a.a,a.j,fz(d,a.f),a.attributes),d.f.set(c,b),d.o.push(b),c=b):c=null,c&&a.l.push(c.getId());e=iz(d);f=[];a=_.w(d.a.values());for(c=a.next();!c.done;c=a.next())f.push.apply(f,
_.eh(c.value.build(d.l)));return{cues:e,styles:f}};qz.prototype.a=function(a){a=(new pz(this.f)).parseMedia(a,{periodStart:0,segmentStart:null,segmentEnd:0}).cues;var b="WEBVTT\n\n";a=_.w(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=rz(c.startTime)+" --\x3e "+rz(c.endTime),e=[];switch(c.textAlign){case _.Be:e.push("align:left");break;case _.Sf:e.push("align:right");break;case _.Gi:e.push("align:middle");break;case _.Be:e.push("align:start");break;case _.Sf:e.push("align:end")}switch(c.writingMode){case _.Eg:e.push("vertical:lr");break;
case _.Hg:e.push("vertical:rl")}b+=d+(e.length?" "+e.join(" "):"")+"\n";b+=c.payload+"\n\n"}return _.T.$a(b)};sz.prototype.probe=function(a,b){return a===_.Wc&&b===_.og};sz.prototype.create=function(a){return new qz(a)};tz.prototype.parseInit=function(a){var b=!1;(new _.qn).N(_.Te,_.rn).N(_.rg,_.rn).N(_.Oe,_.rn).N(_.Se,_.rn).N(_.hg,_.rn).X(_.jg,_.sn).N("stpp",function(c){b=!0;c.parser.stop()}).parse(a);if(!b)throw new _.O(_.P,2,2007);};
tz.prototype.parseMedia=function(a,b){var c=this,d=!1,e=[],f=[],g=[];(new _.qn).N("moof",_.rn).N("traf",_.rn).X("subs",function(h){for(var l=_.ln(h.reader),m=0;m<l;++m){h.reader.skip(4);for(var n=_.kn(h.reader),p=0;p<n;++p){var q=1===h.version?_.ln(h.reader):_.kn(h.reader);g.push(q);h.reader.skip(6)}}}).N(_.Ne,_.tn(function(h){d=!0;h=c.a.parseMedia(h,b,g);e=e.concat(h.cues);f=f.concat(h.styles)})).parse(a);d||this.g.warn("Couldn't find the mdat box");return{cues:e,styles:f}};_.x(uz,_.Kt);uz.prototype.f=function(){_.lv(_.Wc,pz);_.lv(_.Uc,tz);_.lv(my,tz);_.lv(oy,tz);_.lv(ny,tz);_.hl.push(this.j)};uz.prototype.a=function(){_.vv(_.Wc);_.vv(_.Uc);_.vv(my);_.vv(oy);_.vv(ny);_.jl(this.j)};uz.prototype.id=function(){return"subtitles-ttml"};_.J("clpp.ttml.TtmlComponent",uz);};
if(typeof(module)!="undefined"&&module.exports){var x=require("./cl.core.js");_ = x._;(f.call(g,this));module.exports=g;}
else if (typeof(define)!="undefined"&&define.amd) {define(["./cl.core"], function(c){_=c._;(f.call(g,this));return g;});}
else{_=this.clpp._;(f.call(g,this));}
})();