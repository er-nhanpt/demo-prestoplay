(function(){var g={}; var _ = _ || {}
var f=function(window){var YO="An unknown error occurred while trying to get volume",ZO="Cannot get loading rendition due to platform limitations",$O="PARAM_START_POSITION",aP="SecurityError",bP="The require privilege is: http://tizen.org/privilege/tv.audio",cP="|STARTBITRATE\x3d",dP=function(a,b,c){function d(e){c.call(a,e);a.removeEventListener(b,d)}a.addEventListener(b,d)},eP=function(a,b){this.h=a;this.o=null;this.a=_.Te;this.l=null;this.j=!1;this.f=new Map;this.D=b;this.g=new _.K("clpp.tizen.DrmEngine")},hP=function(a){var b,
c,d;return _.I(function(e){if(1==e.a){b=a.a===_.Pd||a.a===_.Nd;if(!b)throw new _.N(_.P,6,6001,"The key system "+a.a+" is not supported by the player or the platform");c=a.f.get(a.a);if(!c.Zd)throw new _.N(_.P,6,6012,"No license server given for "+a.a);_.D(e,2);return a.a===_.Pd?_.y(e,fP(a),5):_.y(e,gP(a,c),5)}if(2!=e.a)return a.o={keySystem:a.a,licenseServerUri:c.Zd,distinctiveIdentifierRequired:!1,persistentStateRequired:c.fg,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],
keyIds:[],periodId:null},_.oh(e,0);d=_.E(e);a.g.error("Error while configuring CDM for "+a.a,d);throw new _.N(_.P,6,6005,{message:JSON.stringify(d)});})},gP=function(a,b){var c,d,e,f;return _.I(function(g){c=iP;d=jP;e={};e[d.Xi]=!b.fg;e[d.Zi]=b.Zd;""!==b.customData&&(e[d.Wi]=b.customData);f=JSON.stringify(e);a.g.debug("PlayReady properties: ",f);try{webapis.avplay.setDrm(c.PLAYREADY,"SetProperties",f)}catch(h){throw h;}_.A(g)})},fP=function(a){var b;return _.I(function(c){b=iP;try{webapis.avplay.setDrm(b.oe,
"Initialize",""),webapis.avplay.setDrm(b.oe,"widevine_app_session",a.l.id),webapis.avplay.setDrm(b.oe,"widevine_data_type",a.l.type)}catch(d){throw d;}_.A(c)})},kP=function(a,b){var c,d,e,f,g,h,l,m,n,p,q,t,v,z,C,F,G;_.I(function(B){if(1==B.a){c=iP;d=a.f.get(a.a);a.g.debug("DRM Challenge data: ",b.challenge);e=atob(b.challenge);f=new Uint8Array(e.length);for(g=0;g<e.length;++g)f[g]=e.charCodeAt(g);h=b.serverurl&&""!==b.serverurl?b.serverurl:d.Zd;l=_.Yj([h],_.Uj());l.type=3;l.body=f.buffer;l.method=
_.Ib;_.D(B,2);return _.y(B,a.D.Jb.fetch(l).U,4)}if(2!=B.a){m=B.f;if(a.j){n=_.zj(m.data);p=n.byteLength;q="";for(t=0;t<p;t++)q+=String.fromCharCode(n[t]);v=btoa(q);z=b.session_id+$O+(v+$O);a.g.debug("Widevine license params",z);try{webapis.avplay.setDrm(c.oe,"widevine_license_data",z)}catch(H){a.g.error("License response rejected by CDM"),C=new _.N(_.P,6,6008,{browserError:JSON.stringify(H)}),a.D.onError(C)}}return _.oh(B,0)}F=_.E(B);a.g.error("License request failed.",JSON.stringify(F));G=new _.N(_.P,
6,6007,{message:_.ab,url:F.data.url,status:F.data.status||NaN,response:F.data.response||"",headers:F.data.headers||{}},F);a.D.onError(G);_.A(B)})},lP=function(a){this.m=a;this.a=this.m.a;this.f=_.Gp;this.j=_.Hp;this.w=(new Date).getTime();this.l=!1;this.o=-1;this.h=2;this.g=new _.K("clpp.tizen.StateManager")},nP=function(a,b){if(a.f!==b)if(a.f===_.Rp&&b!==_.Gp)a.g.debug(_.GC+mP(b));else{var c=(new Date).getTime();a.j=a.f;a.f=b;a.f===_.Lp?(a.o=(new Date).getTime(),a.m.trigger(new _.L(_.kd,{detail:{bufferedTimeMS:-1,
reason:a.h}}))):a.j===_.Lp&&a.m.trigger(new _.L(_.jd,{detail:{bufferedTimeMS:c-a.o,reason:a.h}}));var d={currentState:a.f,previousState:a.j,timeSinceLastStateChangeMS:c-a.w};a.w=c;a.m.trigger(new _.L(_.cg,{detail:d}));a.g.debug("State changed:",mP(a.j),"-\x3e",mP(a.f))}},mP=function(a){return Object.keys(_.Pp)[a]},qP=function(a){if(a.l){var b=a.a.getState(),c=a.f;switch(b){case oP:c=_.Up;break;case pP:c=_.Tp;break;default:a.m.isEnded()?c=_.Np:a.g.debug("Inconsistent AVPlay playback state:",b)}nP(a,
c)}},rP=function(){this.o=this.A=this.f=this.h=this.B=this.m=this.j=this.a=null;this.C=!1;this.w=!0;this.l=null;this.g=new _.K("clpp.tizen.TextStreamer")},sP=function(a){if(!a)return!1;a=a.periods;for(var b=!1,c=0;c<a.length;c++)b=b||0<a[c].textStreams.length;return b},tP=function(a){var b,c;return _.I(function(d){if(1==d.a)return b=a.m.getConfiguration(),c=null,_.y(d,_.pu(a.B.url,a.m.getNetworkEngine(),b.manifest.attemptParameters,a.B.type||null),2);(c=d.f)&&c.configure(b.manifest);return d["return"](c)})},
uP=function(a){var b=document.createElement(_.r),c=new _.VF,d=new _.SD,e=a.m.getTextDisplayer();return new _.XF(b,c,e,d,a.m.getConfiguration())},vP=function(a){var b={configuration:{},Qb:function(){return a.m.getPosition()},W:a.h,Jb:a.m.getNetworkEngine(),Vf:a.yk.bind(a),Uf:a.xk.bind(a),onError:a.S.bind(a),ji:function(){},onEvent:function(){},oi:a.zk.bind(a),Qe:function(){},ze:function(){return new _.yG},rf:function(){return!1},Fd:null};return new _.tH(a.a,b)},wP=function(a){var b=a.m.getPosition(),
c=null;a=_.w(a.a.periods);for(var d=a.next();!d.done;d=a.next())d=d.value,d.startTime<=b&&(c=d);return c},xP=function(a){a.g.debug("getTextStreams()",a.a);if(a.a){var b=[],c=a.a.periods;a.g.debug("getting text streams");for(var d=0;d<c.length;d++)if(a.g.debug(c[d].startTime,a.m.getPosition()),c[d].startTime<=a.m.getPosition()){b=c[d].textStreams;break}a=b}else a=[];b=[];for(d=c=0;d<a.length;d++){var e=new _.zk(String(c++),_.S);e.mimeType=a[d].mimeType;e.language=a[d].language;e.roles=a[d].roles;e.kind=
a[d].kind||_.mD;var f=new _.Ik(String(a[d].id),e);f.bandwidth=a[d].bandwidth||null;e.renditions.push(f);b.push(e)}return b},yP=function(a){if(a.h&&!a.h.getTextDisplayer().isTextVisible())return null;if(a.f){var b=_.wH(a.f,_.Q),c=null;if(b){a=xP(a);for(var d=0;d<a.length;d++)if(a[d].renditions[0].id===String(b.id)){c=a[d].renditions[0];break}}return c}return null},zP=function(a,b){a.g.debug("Set active track",b);if(b&&(a.o=b.language,a.A=b.roles[0]||"",a.C=b.kind===_.pe,a.a&&a.f)){a.setTextVisibility(!0);
var c=wP(a),d=b.renditions[0];(c=c.textStreams.find(function(e){return String(e.id)===d.id}))?(a.w?(a.g.debug("Switching period defer text selection"),a.l=c):(_.HH(a.f,c,!0,0),a.m.trigger(new _.L(_.hm))),a.o=c.language):a.g.error(_.FC,d.id)}},AP=function(){this.h=this.a=this.m=null;this.f={};this.g=new _.K("clpp.tizen.TrackManager");this.w=this.l=this.j=null;this.A=!1;this.o=1},BP=function(a,b){a.m.trigger(new _.L(_.Hg,{details:{width:b.width,height:b.height,bandwidth:b.bandwidth,track:b.track,abrSelection:a.a.o}}))},
CP=function(a){var b=a.ja();b&&a.m.trigger(new _.L(_.hd,{detail:{width:b.width,height:b.height,bandwidth:b.bandwidth,rendition:b}}))},DP=function(a){var b=a.m.getConfiguration(),c=_.vi(b.preferredAudioLanguage||[]),d=a.f[_.Bk]||[];if(d.length){var e=null;c.some(function(g){e=_.JD(g,d.map(function(h){return h.language}));return!!e});if(e){var f=d.filter(function(g){return g.language===e});c=f[0];1<f.length&&b.preferredAudioRole&&(f=f.filter(function(g){return 0<=g.roles.indexOf(b.preferredAudioRole)}),
0<f.length&&(c=f[0]));a.g.debug("Setting audio track with preferred language:",e);a.Ea(c)}else a.g.debug("Preferred language(s) not available")}else a.g.debug("Could not set preferred audio language")},HP=function(a,b){if(b){var c=b.track.type.toUpperCase();EP(a.a,c,Number(b.id)).then(function(){c===FP&&(a.j=b,a.m.trigger(new _.L(_.gm)));c===GP&&(a.l=b,a.m.trigger(new _.L(_.hm)))})["catch"](function(){a.g.error("Could not select "+c+" track.")})}else a.g.debug("Must provide valid rendition")},IP=
function(a,b,c){var d=_.qj(b.language||_.rg);c.language=_.Ak(d);c.originalLanguage=d;c.channelsCount=b.channels?Number(b.channels):null;c.mimeType=_.dd;a=new _.Ik(String(a),c);a.track=c;a.codec=b.fourCC||null;a.bandwidth=b.bit_rate||null;return a},JP=function(a,b,c){c.mimeType=_.Eg;a=new _.Ik(String(a),c);a.track=c;a.width=b.Width||null;a.height=b.Height||null;a.bandwidth=b.Bit_rate?Number(b.Bit_rate):null;a.codec=b.fourCC||null;return a},KP=function(a,b,c){b=_.qj(b.track_lang||_.rg);c.mimeType="text/ttml";
c.language=_.Ak(b);c.originalLanguage=b;c.kind=_.mD;return new _.Ik(String(a),c)},LP=function(a,b){var c=null;try{c=JSON.parse(b)}catch(d){a.g.warn("Couldn't retrieve extra infos from stream."),c=null}return c},OP=function(a,b){function c(n,p){for(var q=0;q<n.length;q++)if(n[q].language===p)return n[q];return null}var d={};if(0>=b.length)return d;for(var e=b.filter(function(n){return n.type===MP}),f=b.filter(function(n){return n.type===FP}),g=[],h=0;h<f.length;h++){var l=LP(a,f[h].extra_info);if(l){var m=
_.qj(l.language||_.rg);m=_.Ak(m);m=c(g,m);m||(m=new _.zk(String(a.o++),_.Bk),g.push(m));m.renditions.push(IP(f[h].index,l,m))}else a.g.warn("Skipping audio stream with no extra info")}f=new _.zk(String(a.o++),_.Ck);for(h=0;h<e.length;h++)(l=LP(a,e[h].extra_info))?f.renditions.push(JP(e[h].index,l,f)):a.g.warn("Skipping video stream with no extra info");e=[];e=a.h?xP(a.h):NP(a,b);d[_.Ck]=[f];d[_.Bk]=g;d[_.S]=e;return d},NP=function(a,b){for(var c=b.filter(function(h){return h.type===GP}),d=[],e=0;e<
c.length;e++){var f=LP(a,c[e].extra_info);if(f){var g=new _.zk(String(a.o++),_.S);g.renditions.push(KP(c[e].index,f,g));d.push(g)}else a.g.warn("Skipping text stream with no extra info")}return d},PP=function(a,b){for(var c=a.f[_.Ck]||[],d=[],e=0;e<c.length;e++)for(var f=0;f<c[e].renditions.length;f++)_.M.ma(c[e].renditions[f],b,Object.keys(b))&&d.push(c[e].renditions[f]);return d[0]||null},QP=function(a,b,c){a=a.f[c]||[];b=String(b.index);c=null;for(var d=0;d<a.length;d++)for(var e=0;e<a[d].renditions.length;e++)if(a[d].renditions[e].id===
b){c=a[d].renditions[e];break}return c},SP=function(a,b){if(b===_.S&&a.h)return yP(a.h);var c=RP(a.a)||[];if(0===c.length)return null;c=c.filter(function(e){return e.type===b.toUpperCase()})[0];var d=null;b===_.Ck&&(d=LP(a,c.extra_info),d=PP(a,{width:d.Width,height:d.Height}));b===_.Bk&&(c?(d=QP(a,c,_.Bk),a.j=d):d=a.j);b===_.S&&(c?(d=QP(a,c,_.S),a.l=d):d=a.l);return d},TP=function(a){_.nm.call(this);this.m=a;this.h=null;this.g=new _.K("clpp.tizen.Middleware");this.C=1;this.B=!1;this.l=null;this.G=
0;this.o=!0;this.f=!1;this.a=null;this.A=1;this.w=!1;this.j={}},UP=function(a){return _.I(function(b){tizen.systeminfo.getPropertyValue("DISPLAY",function(c){a.A=c.resolutionWidth/1920;a.g.debug("Display resolution ratio: ",a.A)},function(c){a.g.debug("Could not load DISPLAY property");throw c;});_.A(b)})},WP=function(a){try{webapis.avplay.setListener({onbufferingstart:a.sk.bind(a),onbufferingprogress:a.rk.bind(a),onbufferingcomplete:a.qk.bind(a),onstreamcompleted:a.vk.bind(a),oncurrentplaytime:function(b){a.trigger(new _.L(VP,
{currentTime:b}))},onevent:a.uk.bind(a),onsubtitlechange:a.wk.bind(a),ondrmevent:a.tk.bind(a),onerror:a.S.bind(a)})}catch(b){a.g.error(b)}},XP=function(a){var b=!!a.m.getTrackManager().Ra();try{webapis.avplay.setSilentSubtitle(!b)}catch(c){a.g.debug("Could not set AVPlay subtitle config",c)}},YP=function(a,b){try{var c=b.estimatedBandwidth||0,d=b.currentBandwidth||0;a.g.debug({estimatedBandwidth:c,po:d});0!==c&&0!==d&&c>=1.15*d&&webapis.avplay.setStreamingProperty("ADAPTIVE_INFO",cP+d)}catch(e){a.g.debug(e)}},
ZP=function(a,b){try{webapis.avplay.setStreamingProperty("ADAPTIVE_INFO","|BITRATES\x3d"+b+cP+b)}catch(c){throw a.g.debug("Could not set fixed bandwidth",c),c;}},bQ=function(a){return{position:a.getPosition(),state:a.m.getState(),Og:a.getState(),playbackRate:a.getPlaybackRate(),isLive:a.isLive(),duration:a.getDuration(),isMuted:$P(a),volume:a.getVolume(),Kn:aQ(a),Lk:RP(a)}},dQ=function(a){var b,c;return _.I(function(d){if(1==d.a)return _.y(d,cQ(),2);if(3!=d.a)return b=new Promise(function(e){(new _.pl(e)).ea(5)}),
_.y(d,Promise.race([UP(a).then(function(){return!0}),b.then(function(){return!1})]),3);c=d.f;if(!c)return a.g.debug("Took to long for the SDK to be ready"),d["return"](Promise.reject("SDK Timeout"));_.A(d)})},jQ=function(a,b,c){var d,e,f,g,h,l,m,n;return _.I(function(p){switch(p.a){case 1:a.l=_.Yp(b);d=a.G;e=c||{estimatedBandwidth:0,currentBandwidth:0,nextBandwidth:null,currentPosition:0};a.g.debug("Loading manifest URL: "+a.l[d].url);f=b.startTime||void 0;a.f&&(a.trigger(new _.L(eQ)),f=c.currentPosition);
_.D(p,2);g=a.l[d].url;h=a.l[d].type;h!==_.Tc||g.includes(".mpd")||(l=new URL(g),l.searchParams.append("cl-ext",".mpd"),g=l.toString());webapis.avplay.open(g);e.nextBandwidth?(ZP(a,e.nextBandwidth),a.o=!1):(a.o||YP(a,e),a.o=!0);WP(a);if(!b.drm||!b.drm.env){a.g.debug("No DRM configuration was provided. Assuming clear content");p.F(4);break}m={onError:function(q){return a.m.onError(q)},Jb:a.m.getNetworkEngine()};a.h=new eP(b.drm,m);return _.y(p,a.h.init(),4);case 4:return a.f||a.trigger(new _.L(fQ)),
_.y(p,gQ(a),6);case 6:a.f||a.trigger(new _.L(hQ));f&&typeof f===_.k&&0<f&&a.seek(f)["catch"](function(q){a.g.debug("Couldn't set start position",q)});a.f||(b.volume&&a.setVolume(b.volume),b.muted&&iQ(a,b.muted),b.autoplay&&a.m.play()["catch"](function(q){a.g.debug("Autoplay failed",q)}));_.oh(p,0);break;case 2:throw n=_.E(p),a.g.debug("Error while attempting to load source."),n;}})},gQ=function(a){return _.I(function(b){a.g.debug("avplay.prepare()");return b["return"](new Promise(function(c,d){try{webapis.avplay.prepareAsync(function(){a.g.debug("AVPlay is ready!");
XP(a);c()},function(e){a.g.debug("prepareAsync failed",e);d(e)})}catch(e){a.g.debug("Failed to prepare media player for playback"),d(e)}}))})},kQ=function(a,b,c){a.g.debug("switchVideoTrack()");try{var d={estimatedBandwidth:parseInt(webapis.avplay.getStreamingProperty("CURRENT_BANDWITH"),10),currentBandwidth:b,nextBandwidth:c,currentPosition:a.getPosition()};a.a=bQ(a);a.f=!0;webapis.avplay.stop();webapis.avplay.close();return a.load(a.m.getConfiguration(),d).then(function(){var e=a.a.Og;a.f=!1;a.a=
null;return e===pP?a.pause():a.play()})}catch(e){return Promise.reject(e)}},aQ=function(a){return a.f&&a.a?a.a.Kn:webapis.avplay.getTotalTrackInfo()},RP=function(a){return a.f&&a.a?a.a.Lk:webapis.avplay.getCurrentStreamInfo()},EP=function(a,b,c){b=b.toUpperCase();b===GP&&lQ(a,!0);var d=a.j[b];d&&(d.Ve.stop(),a.j[b]=null,a.g.debug("Cancelled pending track switch for "+b));return new Promise(function(e,f){function g(h,l,m){m=void 0===m?!1:m;try{webapis.avplay.setSelectTrack(h,l),a.j[h]=null,e()}catch(n){a.g.debug("Could not set "+
h+" track. Trying again...AVPlay state: "+(a.getState()+", buffering: ")+a.w,n),!1===m&&(a.j[h]={type:h,index:l,Lg:0,Ve:new _.pl(function(){return g(h,c,!0)})}),(l=a.j[h])&&3>l.Lg?(!a.w&&++l.Lg,l.Ve.ea(a.w?.5:.25)):(a.g.debug("Could not set track after multiple attempts.Giving up..."),l&&l.Ve.stop(),a.j[h]=null,f())}}g(b,c)})},lQ=function(a,b){var c=a.m.getTextDisplayer();c&&c.setTextVisibility(b);c=a.m.h;try{c||webapis.avplay.setSilentSubtitle(!b)}catch(d){a.g.debug("Could not set text track visibility",
d)}},iQ=function(a,b){try{tizen.tvaudiocontrol.setMute(b)}catch(c){switch(c.name){case aP:a.g.warn("The application does not have the privilege to set mute.",bP);break;default:a.g.warn(YO,c)}}},$P=function(a){var b=null;try{b=tizen.tvaudiocontrol.isMute()}catch(c){switch(c.name){case aP:a.g.warn("The application doesn't have the privilege to get the mute state.",bP);break;default:a.g.warn(YO,c)}}return!!b},cQ=function(){return new Promise(function(a,b){if(window.webapis)a();else{var c=document.createElement("script");
dP(c,_.Ee,function(d){return a(d)});dP(c,_.ne,function(d){return b(d)});c.src="$WEBAPIS/webapis/webapis.js";document.querySelector("head").appendChild(c)}})},mQ=function(){_.nm.call(this);this.a=new TP(this);this.f=new lP(this);this.configuration=this.B=_.tm();this.w=null;this.g=new _.K("clpp.tizen.Player");this.j=null;this.l=new AP;this.C=new _.tk;this.o=this.h=null;this.A=!1},nQ=function(a){if("NONE"!==a.a.getState()){var b=a.j.getBoundingClientRect();a=a.a;var c=Math.floor(b.left*a.A),d=Math.floor(b.top*
a.A),e=Math.floor(b.width*a.A);b=Math.floor(b.height*a.A);a.g.debug("Setting display area to","x:",c,"y:",d,"width:",e,"height:",b);webapis.avplay.setDisplayRect(c,d,e,b);0===c&&0===d&&1920===e&&1080===b&&webapis.avplay.setDisplayMethod("PLAYER_DISPLAY_MODE_LETTER_BOX")}else a.g.debug("Could not apply dimension. Player state "+a.a.getState())},oQ=function(){},pQ=function(){};
eP.prototype.init=function(){var a=this,b,c,d,e,f,g;return _.I(function(h){if(1==h.a){b=_.Om[a.h.env]||null;if(!b)throw a.g.debug(_.Aa,_.Ob+a.h.env+_.ba),new _.N(_.P,6,6015,_.Ba+a.h.env+"' is missing.");a.l={id:String(Math.floor(1E4*Math.random())),type:"MPEG-DASH"};c=Object.keys(a.h.customData||{}).length?btoa(JSON.stringify(a.h.customData)):"";d=_.Qm(b,a.h.customData);(e=d[_.Nd])&&a.f.set(_.Nd,{Zd:e.licenseUrl||"",customData:c,fg:!1});(f=d[_.Pd])&&a.f.set(_.Pd,{Zd:f.licenseUrl||"",customData:c,
fg:!1});if(0===a.f.size)throw new _.N(_.P,6,6E3);if((g=a.h.preferredDrmSystem)&&a.f.get(g))a.a=g;else if(a.f.get(_.Nd))a.a=_.Nd;else if(a.f.get(_.Pd))a.a=_.Pd;else throw new _.N(_.P,6,6001,"Configuration for the target system is missing.");return _.y(h,hP(a),2)}a.j=!0;_.A(h)})};eP.prototype.release=function(){var a=this;return _.I(function(b){a.j=!1;a.o=null;a.a=_.Te;a.l=null;a.f=new Map;_.A(b)})};eP.prototype.getDrmInfo=function(){return this.o};
var jP={Xi:"DeleteLicenseAfterUse",Zi:"LicenseServer",Zn:"GetChallenge",$n:"HttpHeader",bo:"UserAgent",Vn:"Cookie",Wi:"CustomData"};_.u=lP.prototype;_.u.initialize=function(){this.a.on(eQ,this.kh,this);this.a.on(qQ,this.jh,this);this.a.on(rQ,this.ih,this);this.a.on(fQ,this.ri,this);this.a.on(hQ,this.pi,this);this.a.on(sQ,this.lh,this)};_.u.release=function(){nP(this,_.Gp);this.l=!1;this.o=-1;this.h=2};_.u.destroy=function(){this.release();this.a.off(eQ,this.kh);this.a.off(qQ,this.jh);this.a.off(rQ,this.ih);this.a.off(fQ,this.ri);this.a.off(hQ,this.pi);this.a.off(sQ,this.lh);this.m=this.a=null};
_.u.kh=function(){this.g.debug("Buffering start. Player state: ",this.a.getState());this.h=this.a.B?1:2;nP(this,_.Lp)};_.u.jh=function(a){this.g.debug("Buffering progress: "+a.percent+" %. Player state: ",mP(this.f))};_.u.ih=function(){this.g.debug("Buffering complete. Player state: ",this.a.getState());if(!this.l){this.l=!0;var a=this.m.getConfiguration().autoplay,b=this.a.getState()===tQ;if(!a&&b){nP(this,_.Tp);return}}if(a=this.f!==_.Sp)a=this.a.getState(),a=a===oP||a===pP;a&&qP(this)};
_.u.ri=function(){this.g.debug("Preparing starts. AVPlay State: ",this.a.getState());this.a.getState()===uQ?nP(this,_.Sp):this.g.error("AVPlay prepares while state is not IDLE")};_.u.pi=function(){this.g.debug("Preparing ends: AVPlay state:",this.a.getState())};_.u.lh=function(){nP(this,_.Np)};_.u.getState=function(){return this.f};_.u=rP.prototype;_.u.initialize=function(a){this.m=a};
_.u.load=function(a){var b=this,c,d,e,f,g,h,l;return _.I(function(m){switch(m.a){case 1:if(!b.m)return b.g.debug("Text streamer is not initialized. Will not load()"),m["return"]();b.B=a;c=b;return _.y(m,tP(b),2);case 2:c.j=m.f;if(!b.j)return b.g.debug("Could not find manifest parser for source. Make sure parsers are registered."),m["return"]();d={configurationId:"",networkingEngine:b.m.getNetworkEngine(),filterNewPeriod:function(){},filterAllPeriods:function(){},onEvent:function(){},onError:function(){}};
_.D(m,3);e=b;return _.y(m,b.j.start(a.url,d),5);case 5:e.a=m.f;_.oh(m,4);break;case 3:return f=_.E(m),b.g.warn(f),_.D(m,6),g=b,_.y(m,b.j.start(a.url.replace("https://","http://"),d),8);case 8:g.a=m.f;_.oh(m,4);break;case 6:h=_.E(m),b.g.error(h),b.a=null;case 4:if(!b.a||!sP(b.a)){m.F(0);break}b.h=uP(b);_.D(m,10);return _.y(m,b.h.open(),12);case 12:b.f=vP(b);l=b.m.getConfiguration();b.f.h=l.streaming;b.o=l.preferredTextLanguage;b.A=l.preferredTextRole;b.C=l.preferForcedSubtitles;_.oh(m,0);break;case 10:_.E(m),
b.g.debug("Could not setup media source..."),b.h=null,b.f=null,b.j=null,b.a=null,_.A(m)}})};_.u.yk=function(a){this.g.debug(_.eD,a);this.w=!0;var b=_.xG(a.textStreams,this.o||"",this.A||"",this.C)[0]||null;this.l&&(a.textStreams.includes(this.l)&&(b=this.l),this.l=null);return{variant:null,text:b}};_.u.xk=function(){this.g.debug("canSwitch_");this.w=!1;this.l&&(_.HH(this.f,this.l,!0,0),this.l=null)};_.u.S=function(){this.g.debug("onError_")};_.u.zk=function(){this.j&&this.j.update&&this.j.update()};
_.u.start=function(){var a=this;return _.I(function(b){if(!a.f)return b["return"]();try{a.f.start()}catch(c){a.g.error("Error while starting streaming engine",c)}_.A(b)})};_.u.setTextVisibility=function(a){this.g.debug("Set text visibility",a);this.h&&this.h.getTextDisplayer().setTextVisibility(a)};_.u.release=function(){var a=this;return _.I(function(b){a.m=null;a.a=null;a.B=null;a.A=null;a.o=null;a.w=!0;a.l=null;_.A(b)})};
_.u.destroy=function(){var a=this;return _.I(function(b){switch(b.a){case 1:if(!a.j){b.F(2);break}return _.y(b,a.j.stop(),3);case 3:a.j=null;case 2:if(!a.f){b.F(4);break}return _.y(b,a.f.destroy(),5);case 5:a.f=null,a.w=!0;case 4:if(!a.h){b.F(0);break}return _.y(b,a.h.destroy(),7);case 7:a.h=null,_.A(b)}})};_.x(AP,_.U);_.u=AP.prototype;_.u.gi=function(a){var b=a.eventid;a=a.data;switch(b){case vQ:0<Object.keys(this.f).length||(this.g.debug("Loading track manager!"),this.load());b=webapis.avplay.getCurrentStreamInfo();0<b.length&&(b=+LP(this,b[0].extra_info).Bit_rate,b=PP(this,{bandwidth:b}))&&(this.w=b,BP(this,b));break;case wQ:CP(this);break;default:this.g.debug("Event type: "+b+" data: "+a)}};_.u.$f=function(a){a.detail.currentState===_.Up&&this.m.off(_.cg,this.$f)};
_.u.initialize=function(a){var b=this;this.m=a;this.a=this.m.a;this.m.on(_.cg,function(c){b.A||(c=c.detail,c.currentState===_.Up&&(b.g.debug("Current state",c.currentState),b.A=!0,DP(b)))});this.a.on(xQ,this.gi,this)};_.u.release=function(){this.f={};this.h=this.w=this.l=this.j=null;this.A=!1;this.o=1};
_.u.load=function(){if(this.a&&!(0<Object.keys(this.f).length)){this.h=this.m.h;this.m.off(_.cg,this.$f);this.m.on(_.cg,this.$f,this);try{var a=aQ(this.a);this.f=OP(this,a);var b=this.f[_.Bk]||[];b.length&&(this.j=b[0].renditions[0]||null);CP(this)}catch(c){this.g.debug("Could not load track manager")}}};_.u.destroy=function(){this.a.off(xQ,this.gi);this.a=this.m=null};_.u.getVideoTracks=function(){return this.f[_.Ck]||[]};_.u.getAudioTracks=function(){return this.f[_.Bk]||[]};
_.u.ia=function(){return this.f[_.S]||[]};_.u.ja=function(){return SP(this,_.Ck)};_.u.Va=function(){return SP(this,_.Bk)};_.u.Ra=function(){return SP(this,_.S)};_.u.qb=function(){return this.w};_.u.Ab=function(){this.g.info(ZO);return null};_.u.Bb=function(){this.g.info(ZO);return null};_.u.Ga=function(){var a=this.ja();return a?a.track:null};_.u.na=function(){var a=this.Va();return a?a.track:null};_.u.xa=function(){var a=this.Ra();return a?a.track:null};
_.u.xb=function(a){var b=this;null===a?(a=this.ja(),kQ(this.a,a.bandwidth,null).then(function(){CP(b)})):0<a.renditions.length&&this.hb(a.renditions[0])};_.u.Ea=function(a){a?HP(this,a.renditions[0]):this.g.warn("Cannot disable audio tracks on this platform.","Consider muting audio instead...")};_.u.Ta=function(a){a?(a=a.renditions[0],this.h?zP(this.h,a.track):HP(this,a)):(this.g.debug("Disabling text tracks"),this.l=null,lQ(this.a,!1),this.m.trigger(new _.L(_.hm)))};
_.u.hb=function(a){var b=this,c=this.ja();this.a.o||a.width!==c.width||a.height!==c.height||a.bandwidth!==c.bandwidth?(this.w=a,BP(this,a),kQ(this.a,c.bandwidth,a.bandwidth).then(function(){CP(b)})["catch"](function(d){var e=new _.N(_.P,7,7200,{tizenerror:d});b.g.debug("Error while switching video track",d);b.m.onError(e)})):this.g.debug("Trying to switch to already active rendition. Doing nothing...")};_.u.vb=function(a){HP(this,a)};_.u.wb=function(a){this.h?zP(this.h,a.track):HP(this,a)};
_.u.addTextTrack=function(){};_.u.ra=function(){return this.a.o};AP.prototype.isAbrEnabled=AP.prototype.ra;AP.prototype.addTextTrack=AP.prototype.addTextTrack;AP.prototype.setTextRendition=AP.prototype.wb;AP.prototype.setAudioRendition=AP.prototype.vb;AP.prototype.setVideoRendition=AP.prototype.hb;AP.prototype.setTextTrack=AP.prototype.Ta;AP.prototype.setAudioTrack=AP.prototype.Ea;AP.prototype.setVideoTrack=AP.prototype.xb;AP.prototype.getTextTrack=AP.prototype.xa;AP.prototype.getAudioTrack=AP.prototype.na;
AP.prototype.getVideoTrack=AP.prototype.Ga;AP.prototype.getLoadingTextRendition=AP.prototype.Bb;AP.prototype.getLoadingAudioRendition=AP.prototype.Ab;AP.prototype.getLoadingVideoRendition=AP.prototype.qb;AP.prototype.getTextRendition=AP.prototype.Ra;AP.prototype.getAudioRendition=AP.prototype.Va;AP.prototype.getVideoRendition=AP.prototype.ja;AP.prototype.getTextTracks=AP.prototype.ia;AP.prototype.getAudioTracks=AP.prototype.getAudioTracks;AP.prototype.getVideoTracks=AP.prototype.getVideoTracks;_.x(TP,_.nm);_.u=TP.prototype;_.u.sk=function(){this.w=!0;this.f||this.trigger(new _.L(eQ))};_.u.rk=function(a){this.w=!0;this.trigger(new _.L(qQ,{percent:a}))};_.u.qk=function(){this.w=!1;this.trigger(new _.L(rQ))};_.u.vk=function(){this.trigger(new _.L(sQ))};_.u.uk=function(a,b){this.trigger(new _.L(xQ,{eventid:a,data:b}))};_.u.wk=function(a,b,c,d,e){this.trigger(new _.L(yQ,{duration:a,text:b,subtitleType:c,attriCount:d,attributes:e}))};
_.u.tk=function(a,b){this.trigger(new _.L(zQ,{drmType:a,drmData:b}));if(this.h){var c=this.h;if(c.j)if(c.a===_.Pd&&"Challenge"===b.name)kP(c,b);else if("DrmError"===b.name){c.g.debug("DrmError event",b);var d=new _.N(_.P,6,6005,{message:JSON.stringify(b)});c.D.onError(d)}}};_.u.S=function(a){this.trigger(new _.L(AQ,{eventType:a}))};
_.u.play=function(){function a(){return new Promise(function(d,e){function f(){d();clearTimeout(g)}var g=null;b.one(VP,f,b);g=setTimeout(function(){b.off(VP,f);e("Timeout")},3E4)})}var b=this,c=this.getState();if(c===uQ)return(new Promise(function(d,e){webapis.avplay.prepareAsync(function(){XP(b);d(webapis.avplay.play())},function(f){b.trigger(new _.L(AQ));e(f)})})).then(function(){return a()});if(c===pP||c===tQ)try{return webapis.avplay.play(),a()}catch(d){return Promise.reject(d)}return c===oP?
Promise.resolve():Promise.reject("Player is in invalid state")};_.u.pause=function(){try{webapis.avplay.pause()}catch(a){Promise.reject(a)}return this.getState()===pP?Promise.resolve():Promise.reject()};
_.u.setPlaybackRate=function(a){var b=this.getState();if(b===tQ||b===oP||b===pP){try{webapis.avplay.setSpeed(a),this.C=a}catch(c){return this.g.debug("Error while trying to set playback rate",c),this.setPlaybackRate(this.C)}return!0}this.g.debug("Cannot set playback rate; AVPlay is in inconsistent state: "+b);return!1};_.u.getPlaybackRate=function(){return this.C};
_.u.load=function(a,b){var c=this,d;return _.I(function(e){switch(e.a){case 1:return c.g.debug("configure()",b||""),_.D(e,2),_.y(e,dQ(c),4);case 4:return _.y(e,jQ(c,a,b),5);case 5:_.oh(e,0);break;case 2:throw d=_.E(e),new _.N(_.P,7,7003,null,d);}})};_.u.getState=function(){if(this.f&&this.a)return this.a.Og;try{return webapis.avplay.getState()}catch(a){this.S(JSON.stringify(a))}};
_.u.seek=function(a){var b=this,c=1E3*a;return new Promise(function(d,e){b.B=!0;b.m.trigger(new _.L(_.xg));webapis.avplay.seekTo(c,function(){b.B=!1;b.m.trigger(new _.L(_.wg));d()},function(){b.B=!1;e()})})};_.u.getPosition=function(){if(this.f&&this.a)return this.a.position;try{return webapis.avplay.getCurrentTime()/1E3}catch(a){this.S(JSON.stringify(a))}};_.u.getDuration=function(){if(this.f&&this.a)return this.a.duration;try{return webapis.avplay.getDuration()/1E3}catch(a){this.S(JSON.stringify(a))}};
_.u.release=function(){var a=this;return new Promise(function(b,c){try{a.h&&(a.h.release(),a.h=null);webapis.avplay.stop();webapis.avplay.close();for(var d in a.j){var e=a.j[d];e&&e.Ve.stop()}a.j={};a.C=1;a.B=!1;a.l=null;a.a=null;return b()}catch(f){return c(f)}})};_.u.getVolume=function(){var a=null;try{a=tizen.tvaudiocontrol.getVolume()}catch(b){switch(b.name){case aP:this.g.debug("The application does not have the privilege to get the volume.",bP);break;default:this.g.debug(YO,b)}}return a};
_.u.setVolume=function(a){try{tizen.tvaudiocontrol.setVolume(Math.max(0,Math.min(100*a,100)))}catch(b){switch(b.name){case "InvalidValueError":this.g.warn("Invalid value passed for setVolume.","The passed value value should be in the range of 0 to 1.");break;case aP:this.g.warn("The application does not have the privilege to set the volume.",bP);break;default:this.g.warn("An unknown error occurred while trying to set volume",b)}}};
_.u.isLive=function(){if(this.f&&this.a)return this.a.isLive;try{return"1"===webapis.avplay.getStreamingProperty("IS_LIVE")}catch(a){this.S(JSON.stringify(a))}};_.u.stop=function(){try{webapis.avplay.stop()}catch(a){this.g.debug(a)}};_.u.getDrmInfo=function(){this.h&&this.h.getDrmInfo();return null};_.u.setSourceIndex=function(a){this.G=a};_.u.getSourceIndex=function(){return this.G};_.u.getLoadedSource=function(){return this.l&&this.l[this.getSourceIndex()]};
var uQ="IDLE",tQ="READY",oP="PLAYING",pP="PAUSED",MP=_.jc,FP="AUDIO",GP="TEXT",wQ="PLAYER_MSG_RESOLUTION_CHANGED",vQ="PLAYER_MSG_BITRATE_CHANGE",iP={PLAYREADY:"PLAYREADY",Xn:"EME_PLAYREADY",co:"VERIMATRIX",oe:"WIDEVINE_CDM",Yn:"EME_WIDEVINE_CDM",fo:"WIDEVINE_CLASSIC"};_.x(mQ,_.nm);_.u=mQ.prototype;_.u.gh=function(){var a=this;this.g.debug("On Stream completed. Current time: ",this.getPosition());this.trigger(new _.L(_.me));this.configuration.loop?this.seek(this.configuration.startTime||0)["catch"](function(){a.g.debug("Could not loop playback")}):this.a.stop()};_.u.eh=function(a){this.trigger(new _.L(_.ng,{currentTime:a.currentTime/1E3}))};
_.u.hh=function(a){var b=this.a.getPosition(),c=b+a.duration/1E3,d=a.text||"";this.g.debug("Got subtitles: ",d,"start:",b,"end:",c,a);(d=_.R.vg(d))&&this.o.append([new _.Hi(b,c,d)],[])};_.u.fh=function(a){this.g.debug("DRM event: "+a.drmType+", data: "+a.drmData)};_.u.ii=function(){this.A||(this.g.debug("Initial buffering completed..."),this.A=!0)};
_.u.S=function(a){this.g.debug("Error: TYPE: "+a.eventType);nP(this.f,_.Rp);a=new _.N(_.P,7,7200,{tizenerror:a.eventType});this.a.release();this.trigger(new _.L(_.ne,{detail:a}))};
_.u.init=function(a,b){this.configuration=this.B=b;this.w=a;this.a.on(sQ,this.gh,this);this.a.on(VP,this.eh,this);this.a.on(yQ,this.hh,this);this.a.on(zQ,this.fh,this);this.a.on(AQ,this.S,this);this.a.on(rQ,this.ii,this);this.f.initialize();this.l.initialize(this);this.g.debug("Initializing player surface");this.w.hideMediaElement();var c=BQ;BQ+=1;this.j=_.tq(_.Ue,{id:"__clpp_tizen_player_"+c,type:"application/avplayer"});this.w.addElementToContainer(this.j,!0);var d=this.w.getMedia();if(d){c=this.j;
var e=[_.Sg,_.se,"position",_.ye,"top"],f={};d=null!==d.parentElement?window.getComputedStyle(d,null):d.style;if(!e||0===e.length){e||(e=[]);for(var g in d)e.push(g)}g=_.w(e);for(e=g.next();!e.done;e=g.next())e=e.value,f[e]=d[e];_.vq(c,f);nQ(this)}};_.u.getSurface=function(){return this.w};_.u.getConfiguration=function(){return this.configuration};_.u.getTimeline=function(){return null};_.u.setupPlaylist=function(){return Promise.reject(_.Eb)};_.u.appendLoad=function(){return Promise.reject(_.Eb)};
_.u.seekWith=function(){return Promise.reject(_.Eb)};_.u.setSeekInterceptor=function(){};_.u.setPlaybackSessionId=function(){};
_.u.destroy=function(){var a=this;return _.I(function(b){switch(b.a){case 1:return _.y(b,a.release(),2);case 2:a.a.off(sQ,a.gh);a.a.off(VP,a.eh);a.a.off(yQ,a.hh);a.a.off(zQ,a.fh);a.a.off(AQ,a.S);a.a.off(rQ,a.ii);if(!a.h){b.F(3);break}return _.y(b,a.h.destroy(),4);case 4:a.h=null;case 3:a.j&&(a.j.parentElement.removeChild(a.j),a.j=null),a.l.destroy(),a.f.destroy(),a.l=null,a.f=null,_.A(b)}})};_.u.namespace=function(){return CQ};_.u.getPlaybackRate=function(){return this.a.getPlaybackRate()};
_.u.setDrmCustomDataModifier=function(){};_.u.setCdnErrorCallback=function(){};_.u.detach=function(){};_.u.setPlaybackRate=function(a){this.a.setPlaybackRate(a)};_.u.getPosition=function(){return this.getMediaPosition()};_.u.getMediaPosition=function(){return 0<(this.configuration.startTime||0)&&!this.A?0:this.f.getState()===_.Np?this.getDuration():this.a.getPosition()||0};_.u.seek=function(a){return typeof a===_.k&&0<=a?(this.isLive()||(a=Math.min(a,this.getDuration())),this.a.seek(a)):Promise.reject()};
_.u.getPresentationStartTime=function(){return null};_.u.getSeekRange=function(){return{start:0,end:0}};_.u.getVolume=function(){var a=this.a.getVolume();return typeof a===_.k?a/100:null};_.u.setVolume=function(a){this.a.setVolume(a)};_.u.getDuration=function(){return this.getMediaDuration()};_.u.getMediaDuration=function(){return this.a.getDuration()};_.u.getBufferInfo=function(){this.g.warn(_.ua);return new _.mm};_.u.getTrackManager=function(){return this.l};_.u.unload=function(){var a=this;return this.a.release().then(function(){a.l.release()})};
_.u.release=function(){var a=this;return _.I(function(b){switch(b.a){case 1:if(!a.h){b.F(2);break}return _.y(b,a.h.release(),2);case 2:if(!a.o){b.F(4);break}return _.y(b,a.o.destroy(),5);case 5:a.o=null;case 4:return _.y(b,a.a.release(),6);case 6:a.l.release(),a.f.release(),a.A=!1,_.A(b)}})};
_.u.load=function(a){var b=this,c,d,e,f,g;return _.I(function(h){switch(h.a){case 1:b.configuration=_.vm(b.B,a);c=_.up(b.configuration,[_.ue,"native"]);b.o=c.create(b);d=_.Yp(b.configuration)[0];e=!!b.configuration.tizen&&b.configuration.tizen.sideStreamText;if(!e){h.F(2);break}b.h=new rP;b.h.initialize(b);_.D(h,3);return _.y(h,b.h.load(d),5);case 5:b.h.start();_.oh(h,2);break;case 3:f=_.E(h),b.g.error(f);case 2:return _.D(h,6),_.y(h,b.a.load(b.configuration),8);case 8:_.oh(h,7);break;case 6:throw g=
_.E(h),b.onError(g),g;case 7:b.l.load(),_.A(h)}})};_.u.play=function(){var a=this;this.trigger(new _.L(_.hf));nQ(this);return this.a.play().then(function(){qP(a.f)})};_.u.pause=function(){var a=this;return this.a.pause().then(function(){qP(a.f)})};_.u.getState=function(){return this.f.getState()};_.u.getPeriods=function(){return[]};_.u.onError=function(a){var b=new _.L(_.ne,{detail:a});a.severity===_.P&&(nP(this.f,_.Rp),this.a.release());this.trigger(b);b.defaultPrevented&&(b.a=!0)};
_.u.getDrmInfo=function(){return this.a.getDrmInfo()};_.u.isEnded=function(){return this.f.getState()===_.Np};_.u.isPaused=function(){return this.a.getState()===pP};_.u.isMuted=function(){return $P(this.a)};_.u.setMuted=function(a){iQ(this.a,a)};_.u.getNetworkEngine=function(){return this.C};_.u.setNetworkEngine=function(a){this.C=a};_.u.setCmsdManager=function(){};_.u.isLive=function(){return this.a.isLive()};_.u.getStats=function(){return null};_.u.setSourceIndex=function(a){this.a.setSourceIndex(a)};
_.u.getSourceIndex=function(){return this.a.getSourceIndex()};_.u.getLoadedSource=function(){return this.a.getLoadedSource()};_.u.canPlay=function(a,b){return(new oQ).canPlay(a,b)};_.u.getTimelineCues=function(){return[]};_.u.getCueTimeline=function(){return null};_.u.getTextDisplayer=function(){return this.o};_.u.resetAbr=function(){};var CQ="clpp.tizen",BQ=0;oQ.prototype.a=function(){return CQ};
oQ.prototype.canPlay=function(a){a=a.type;var b=!!window.webapis;if((a===_.Tc||a===_.Yl||a===_.Yc)&&b){if(_.ok(2))return 2;if(_.ok(3)||_.ok(4)||_.ok(5)||_.ok(6))return _.Dh("Use of clpp.tizen.TizenComponent is not recommended for Tizen version \x3e\x3d 3."),1}return 0};oQ.prototype.f=function(a){return a===_.pa};oQ.prototype.create=function(){return new mQ};_.x(pQ,_.tt);pQ.prototype.f=function(){_.Nh(new oQ)};pQ.prototype.a=function(){var a=CQ;a&&_.Lh[a]&&(delete _.Lh[a],_.Mh.info("Removed Player factory: '"+a+"'"))};pQ.prototype.id=function(){return"tizen"};_.J("clpp.tizen.TizenComponent",pQ);var eQ="onbufferingstart",qQ="onbufferingprogress",rQ="onbufferingcomplete",sQ="onstreamcompleted",VP="oncurrentplaytime",xQ="onevent",yQ="onsubtitlechange",zQ="ondrmevent",AQ="onerror",fQ="preparingstart",hQ="preparingend";};
if(typeof(module)!="undefined"&&module.exports){var x=require("./cl.core.js");_ = x._;(f.call(g,this));module.exports=g;}
else if (typeof(define)!="undefined"&&define.amd) {define(["./cl.core"], function(c){_=c._;(f.call(g,this));return g;});}
else{_=this.clpp._;(f.call(g,this));}
})();