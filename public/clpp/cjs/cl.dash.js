(function(){var g={}; var _ = _ || {}
var f=function(window){var FM="Channel parsing failure! Ignoring scheme and value",GM="ContentProtection",HM="EssentialProperty",IM="Failed to parse UTCTiming tags.",JM="Missing \x3cms:pro/\x3e node in ContentProtection element",KM="No UTCTiming elements found.",LM="SegmentBase does not contain sufficient segment information:",MM="SegmentList does not contain sufficient segment information:",NM="SegmentTemplate does not contain sufficient segment information:",OM="SegmentTimeline",PM='The last "S" element cannot have a negative repeat',
QM="duration",RM="http://dashif.org/guidelines/trickmode",SM="http://www.w3.org/1999/xlink",TM='ignoring the last "S" element.',UM='ignoring the remaining "S" elements.',VM="presentationTimeOffset",WM="schemeIdUri",XM="static",YM="timescale",ZM="urn:microsoft:playready",$M="urn:mpeg:cenc:2013",aN="urn:mpeg:dash:utc:http-head:2014",bN="urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",cN="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",dN=function(a,b,c){try{var d=a(b);if(d&&d.U&&d.abort)return c.resolve(d.U),
function(){return d.abort()};c.resolve(d);return function(){return Promise.resolve(d).then(function(){})["catch"](function(){})}}catch(e){return c.reject(e),function(){return Promise.resolve()}}},eN=function(a,b,c){function d(){e.reject(new _.N(_.P,7,7001));return a.abort()}var e=new _.gk;a.U.then(function(f){a.a?e.reject(new _.N(_.P,7,7001)):b?d=dN(b,f,e):e.resolve(f)},function(f){c?d=dN(c,f,e):e.reject(f)});return new _.hk(e,function(){return d()})},fN=function(a,b){a.H=Math.max(a.H,b);a.g.debug("notifyAvailabilityTimeOffset: maxAvailabilityTimeOffset\x3d"+
a.H)},gN=function(a,b){return a.reduce(function(c,d,e){return d["catch"](c.bind(null,e))}.bind(null,b),Promise.reject())},hN=function(a){return new _.hk(Promise.reject(a),function(){return Promise.resolve()})},iN=function(a){return new _.hk(Promise.all(a.map(function(b){return b.U})),function(){return Promise.all(a.map(function(b){return b.abort()}))})},jN=function(a,b,c){return Array.prototype.filter.call(a.childNodes,function(d){return d instanceof Element&&d.localName===c&&d.namespaceURI===b})},
kN=function(a,b,c){a=jN(a,b,c);return 1!==a.length?null:a[0]},lN=function(a,b,c){return a.hasAttributeNS(b,c)?a.getAttributeNS(b,c):null},mN=function(a,b,c,d){d=void 0===d?null:d;var e=null;a=a.getAttribute(b);null!=a&&(e=c(a));return null==e?d:e},nN=function(a){if(!a)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(a)&&(a+="Z");a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)},oN=function(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);
if(!b)return _.Dh("Invalid duration string:",a),null;a=31536E3*Number(b[1]||null)+2592E3*Number(b[2]||null)+86400*Number(b[3]||null)+3600*Number(b[4]||null)+60*Number(b[5]||null)+Number(b[6]||null);return isFinite(a)?a:null},pN=function(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=Number(b[1]);if(!isFinite(a))return null;b=Number(b[2]);return isFinite(b)?{start:a,end:b}:null},qN=function(a){a=Number(a);return 0===a%1?a:null},rN=function(a){a=Number(a);return 0===a%1&&0<a?a:null},sN=function(a){a=
Number(a);return 0===a%1&&0<=a?a:null},tN=function(a){var b;a=(b=a.match(/^(\d+)\/(\d+)$/))?Number(b[1])/Number(b[2]):Number(a);return isNaN(a)?null:a},uN=function(a,b){try{var c=_.R.aa(a);return _.Xn(c,b)}catch(d){return null}},vN=function(a){var b=void 0===b?1024:b;if(!(a instanceof Uint8Array))return"";if(typeof b!==_.k||0>=b)b=1024;return(a.byteLength>b?a.subarray(0,b):a).toString()},wN=function(a){return 1>=a?0:Math.floor(Math.random()*a)},xN=function(a,b,c,d,e){var f={RepresentationID:b,Number:c,
Bandwidth:d,Time:e};return a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(g,h,l,m){if("$$"===g)return"$";var n=f[h];if(null==n)return _.Dh("URL template does not have an available substitution ","for identifier",'"'+h+'":',a),g;"RepresentationID"===h&&l&&(_.Dh("URL template should not contain a width specifier for identifier",'"RepresentationID":',a),l=void 0);"Time"===h&&(n=Math.round(n));switch(m){case void 0:case "d":case "i":case "u":g=n.toString();
break;case "o":g=n.toString(8);break;case "x":g=n.toString(16);break;case "X":g=n.toString(16).toUpperCase();break;default:g=n.toString()}l=window.parseInt(l,10)||1;return Array(Math.max(0,l-g.length)+1).join("0")+g})},AN=function(a,b){var c=yN(a,b,YM),d=1;c&&(d=rN(c)||1);c=yN(a,b,QM);(c=rN(c||""))&&(c/=d);var e=Number(yN(a,b,VM))||0,f=e/d||0;a.Hl&&null!=a.Yd&&a.Yd!==f&&(_.Dh("The stream is non-compliant with the DASH spec. The value of `presentationTimeOffset` has changed during the transition from dynamic to static manifest, which is not allowed. The last value will be ignored. (Period ID: "+
(a.Ia.id+", Representation ID: ")+(a.O.id+")")),e=a.Yd*d,f=a.Yd);var g=yN(a,b,"startNumber"),h=sN(g||"");if(null==g||null==h)h=1;g=yN(a,b,"endNumber");g=null!==g?sN(g||""):null;var l=zN(a,b,OM),m=null;if(l){m=d;var n=e,p=a.Ca.duration||Infinity;l=_.Un(l,"S");for(var q=[],t=0,v=0;v<l.length;++v){var z=l[v],C=mN(z,"t",sN),F=mN(z,"d",sN),G=mN(z,"r",qN);null!=C&&(C-=n);if(!F){_.Dh('"S" element must have a duration:',UM,z);break}C=null!=C?C:t;G=G||0;if(0>G)if(v+1<l.length){G=mN(l[v+1],"t",sN);if(null==
G){_.Dh('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:',UM,z);break}else if(C>=G){_.Dh('An "S" element cannot have a negative repeat if its start ','time exceeds the next "S" element\'s start time:',UM,z);break}G=Math.ceil((G-C)/F)-1}else{if(Infinity===p){_.Dh(PM,"if the Period has an infinite duration:",TM,z);break}else if(C/m>=p){_.Dh(PM,"if its start time exceeds the Period's duration:",TM,z);break}G=Math.ceil((p*m-C)/F)-1}0<q.length&&
C!==t&&(Math.abs((C-t)/m)>=_.Cv&&_.Dh("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",z),q[q.length-1].end=C/m);for(z=0;z<=G;++z)t=C+F,q.push({start:C/m,end:t/m,Nn:C}),C=t}m=q}n=yN(a,b,"availabilityTimeOffset");p=Number(n||"");p=isNaN(p)?null:p;if(null==n||null==p)p=0;return{timescale:d,Ka:c,Ac:h,Ff:g,Kb:f,Cg:e,timeline:m,pf:p}},yN=function(a,b,c){return[b(a.O),b(a.ua),b(a.Ia)].filter(_.Qi).map(function(d){return d.getAttribute(c)}).reduce(function(d,e){return d||
e})},zN=function(a,b,c){return[b(a.O),b(a.ua),b(a.Ia)].filter(_.Qi).map(function(d){return _.Vn(d,c)}).reduce(function(d,e){return d||e})},CN=function(a,b,c,d,e,f){for(var g=lN(a,SM,"href"),h=lN(a,SM,"actuate")||"onRequest",l=0;l<a.attributes.length;l++){var m=a.attributes[l];m.namespaceURI===SM&&(a.removeAttributeNS(m.namespaceURI,m.localName),--l)}if(5<=f)return hN(new _.N(_.P,4,4028));if("onLoad"!==h)return hN(new _.N(_.P,4,4027));var n=_.ED([d],[g]);d=_.Yj(n,b);d.type=1;return eN(e.fetch(d),function(p){p=
uN(p.data,a.tagName);if(!p)return hN(new _.N(_.P,4,4001,{uri:g}));for(;a.childNodes.length;)a.removeChild(a.childNodes[0]);for(;p.childNodes.length;){var q=p.childNodes[0];p.removeChild(q);a.appendChild(q)}for(q=0;q<p.attributes.length;q++){var t=p.attributes[q].nodeName,v=p.getAttribute(t);a.setAttribute(t,v)}return BN(a,b,c,n[0],e,f+1)})},BN=function(a,b,c,d,e,f){f=void 0===f?0:f;if(lN(a,SM,"href")){var g=CN(a,b,c,d,e,f);c&&(g=eN(g,void 0,function(){return BN(a,b,c,d,e,f)}));return g}g=[];for(var h=
0;h<a.childNodes.length;h++){var l=a.childNodes[h];l instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"===lN(l,SM,"href")?(a.removeChild(l),--h):l.tagName!==OM&&g.push(BN(l,b,c,d,e,f)))}return eN(iN(g),function(){return a})},DN=function(a,b,c){var d=a.Ca.duration,e=a.Ca.Xh;if(!a.Ef)return e=new _.FE(b),_.bE(e,d),e;var f=a.Ia;var g=a.O;f=f&&f.id&&g&&g.id?f.id+","+g.id:null;if(!a.bi||null==c[f])return a=new _.FE(b),e||_.bE(a,d),c[f]=a;c=c[f];e||_.bE(new _.FE(b),d);c.pa(b);_.HE(c,_.tE(a.presentationTimeline)-
a.Ca.start);return c},EN=function(a,b){var c=a.presentationTimeline,d=_.ah(b.a).concat();c.l||0===d.length||(c.J=Math.floor(Math.max(c.J||0,d[d.length-1].endTime+a.Ca.start)));a.bi||_.qE(a.presentationTimeline,_.ah(b.a).concat(),a.Ca.start)},FN=function(a){return""===a.id?a.schemeIdUri+":"+a.startTime+":"+a.endTime:a.id},HN=function(a,b,c,d){var e,f=(new _.gn).Y("sidx",function(h){e=GN(b,d,c,h)});a&&f.parse(a);if(e)return e;f=b+"-"+(b+a.byteLength-1);var g=c[0];a=_.zj(a);_.Jh('Invalid box type. Expected "sidx", but received:',
a,"from:",g,"byte range:",f);throw new _.N(_.P,3,3004,{url:g,mo:f,size:a.byteLength,Fo:vN(a)});},GN=function(a,b,c,d){var e=[];d.reader.skip(4);var f=_.W(d.reader);if(0===f)throw _.Jh("Invalid timescale."),new _.N(_.P,3,3005);if(0===d.version){var g=_.W(d.reader);var h=_.W(d.reader)}else g=_.dn(d.reader),h=_.dn(d.reader);d.reader.skip(2);var l=_.bn(d.reader);a=a+d.size+h;for(h=0;h<l;h++){var m=_.W(d.reader),n=(m&2147483648)>>>31;m&=2147483647;var p=_.W(d.reader);d.reader.skip(4);if(1===n)throw _.Jh("Hierarchical SIDXs are not supported."),
new _.N(_.P,3,3006);e.push(new _.oj(e.length,g/f-b,(g+p)/f-b,function(){return c},a,a+m-1,b));g+=p;a+=m}d.parser.stop();return e},IN=function(a){this.f=a;this.a=new _.Ym(a,!1)},MN=function(a){var b=JN(a);if(7<b.length)throw new _.N(_.P,3,3002);for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=JN(a);a:{d=_.w(KN);for(var e=d.next();!e.done;e=d.next())if(_.Oj(c,new Uint8Array(e.value))){d=!0;break a}d=!1}if(d)c=a.f.byteLength-a.a.getPosition();else{if(8===c.length&&c[1]&224)throw new _.N(_.P,3,3001);
d=c[0]&(1<<8-c.length)-1;for(e=1;e<c.length;e++)d=256*d+c[e];c=d}c=a.a.getPosition()+c<=a.f.byteLength?c:a.f.byteLength-a.a.getPosition();d=new DataView(a.f.buffer,a.f.byteOffset+a.a.getPosition(),c);a.a.skip(c);return new LN(b,d)},JN=function(a){var b=_.an(a.a),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new _.N(_.P,3,3002);var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=_.an(a.a);return d},LN=function(a,b){this.id=a;this.a=b},NN=function(a){if(8<a.a.byteLength)throw new _.N(_.P,3,3002);if(8===
a.a.byteLength&&a.a.getUint8(0)&224)throw new _.N(_.P,3,3001);for(var b=0,c=0;c<a.a.byteLength;c++){var d=a.a.getUint8(c);b=256*b+d}return b},ON=function(){},QN=function(a,b,c,d,e,f){function g(){return e}var h=[];a=new IN(a.a);for(var l=null,m=null;_.Zm(a.a);){var n=MN(a);if(187===n.id){var p=PN(n);p&&(n=c*p.On,p=b+p.hn,null!=l&&h.push(new _.oj(h.length,l-f,n-f,g,m,p-1,f)),l=n,m=p)}}null!=l&&h.push(new _.oj(h.length,l-f,d-f,g,m,null,f));return h},PN=function(a){var b=new IN(a.a);a=MN(b);if(179!==
a.id)throw _.Dh("Not a CueTime element."),new _.N(_.P,3,3013);a=NN(a);b=MN(b);if(183!==b.id)throw _.Dh("Not a CueTrackPositions element."),new _.N(_.P,3,3012);b=new IN(b.a);for(var c=0;_.Zm(b.a);){var d=MN(b);if(241===d.id){c=NN(d);break}}return{On:a,hn:c}},RN=function(a,b){var c=zN(a,b,"Initialization");if(!c)return null;var d=a.O.lb,e=c.getAttribute("sourceURL");e&&(d=_.ED(a.O.lb,[e]));e=0;var f=null;if(c=mN(c,"range",pN))e=c.start,f=c.end;return new _.GD(function(){return d},e,f)},UN=function(a,
b){var c=Number(yN(a,SN,VM))||0,d=yN(a,SN,YM),e=1;d&&(e=rN(d)||1);c=c/e||0;d=RN(a,SN);e=a.O.mimeType.split("/")[1];if(a.O.contentType!==_.Q&&"mp4"!==e&&"webm"!==e)throw _.Jh("SegmentBase specifies an unsupported container type.",a.O),new _.N(_.P,4,4006);if("webm"===e&&!d)throw _.Jh(LM,"the SegmentBase uses a WebM container,","but does not contain an Initialization element.",a.O),new _.N(_.P,4,4005);var f=zN(a,SN,"RepresentationIndex"),g=yN(a,SN,"indexRange"),h=a.O.lb;g=pN(g||"");if(f){var l=f.getAttribute("sourceURL");
l&&(h=_.ED(a.O.lb,[l]));g=mN(f,"range",pN,g)}if(!g)throw _.Jh(LM,"the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",a.O),new _.N(_.P,4,4002);a.presentationTimeline.B=null;e=TN(a,b,d,h,g.start,g.end,e,c);return{createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,adjustSegmentDurations:e.adjustSegmentDurations,getDuration:e.getDuration,initSegmentReference:d,getLastSegmentEndTime:e.getLastSegmentEndTime,
Da:c}},TN=function(a,b,c,d,e,f,g,h){var l=a.presentationTimeline,m=!a.Ef||!a.Ca.Xh,n=a.Ca.start,p=a.Ca.duration,q=b,t=null;return{createSegmentIndex:function(v){var z,C,F,G,B,H;return _.I(function(O){if(1==O.a)return z=[q(d,e,f,v),"webm"===g?q(c.Xa(),c.ya,c.la,v):null],q=null,_.y(O,Promise.all(z),2);C=O.f;F=C[0];G=C[1]||null;B=null;"mp4"===g?B=HN(F,e,d,h):(H=new ON,B=H.parse(F,G,d,h));_.qE(l,B,n);t=new _.FE(B);m&&_.bE(t,p);return O["return"](C)})},findSegmentPosition:function(v){return t.Uc(v)},getSegmentReference:function(v){return t.get(v)},
adjustSegmentDurations:function(v,z){return t.qd(v,z)},getDuration:function(){return t.getDuration()},getLastSegmentEndTime:function(){return p}}},SN=function(a){return a.ce},aO=function(a,b,c,d){var e=VN(a),f=WN(a);XN(a,f);var g=null;if(f.Ud)a.presentationTimeline.B=null,g=YN(a,b,e,f);else if(f.Ka)d||(a.presentationTimeline.B=null,fN(a.presentationTimeline,f.pf),_.rE(a.presentationTimeline,f.Ka),_.oE(a.presentationTimeline,a.Ca.start)),g=ZN(a,f);else{b=$N(a,f);var h=DN(a,b,c);EN(a,h);g={createSegmentIndex:Promise.resolve.bind(Promise),
findSegmentPosition:h.Uc.bind(h),getSegmentReference:h.get.bind(h),adjustSegmentDurations:h.qd.bind(h),getDuration:h.getDuration.bind(h),getLastSegmentEndTime:function(){return _.GE(h)}}}return{createSegmentIndex:g.createSegmentIndex,findSegmentPosition:g.findSegmentPosition,getSegmentReference:g.getSegmentReference,adjustSegmentDurations:g.adjustSegmentDurations,getDuration:g.getDuration,initSegmentReference:e,getLastSegmentEndTime:g.getLastSegmentEndTime,Da:f.Kb}},bO=function(a){return a.jc},WN=
function(a){var b=AN(a,bO),c=yN(a,bO,"media");a=yN(a,bO,"index");return{Ka:b.Ka,timescale:b.timescale,Ac:b.Ac,Ff:b.Ff,Kb:b.Kb,Cg:b.Cg,timeline:b.timeline,Rf:c,Ud:a,pf:b.pf}},XN=function(a,b){var c=b.Ud?1:0;c+=b.timeline?1:0;c+=b.Ka?1:0;if(0===c)throw _.Jh("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",a.O),new _.N(_.P,4,4002);1!==c&&(_.Dh("SegmentTemplate contains multiple segment information sources:",
"the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",a.O),b.Ud?(_.Hh("Using the index URL template by default."),b.timeline=null):_.Hh("Using the SegmentTimeline by default."),b.Ka=null);if(!b.Ud&&!b.Rf)throw _.Jh(NM,"the SegmentTemplate's media URL template is missing.",a.O),new _.N(_.P,4,4002);},YN=function(a,b,c,d){var e=a.O.mimeType.split("/")[1];if("mp4"!==e&&"webm"!==e)throw _.Jh("SegmentTemplate specifies an unsupported container type.",
a.O),new _.N(_.P,4,4006);if("webm"===e&&!c)throw _.Jh(NM,"the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",a.O),new _.N(_.P,4,4005);var f=xN(d.Ud,a.O.id,null,a.bandwidth||null,null);f=_.ED(a.O.lb,[f]);return TN(a,b,c,f,0,null,e,d.Kb)},ZN=function(a,b){var c=b.Rf,d=a.Ca.duration,e=b.Ka,f=b.Ac,g=b.Ff,h=b.timescale,l=a.bandwidth||null,m=a.O.id,n=a.O.lb;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(p){return 0>p||
d&&p>=d?null:Math.floor(p/e)},getSegmentReference:function(p){var q=p+f;if(null!==g&&q>g)return null;var t=p*e,v=t+e;d&&(v=Math.min(v,d));return 0>v||d&&t>=d?null:new _.oj(p,t,v,function(){var z=xN(c,m,q,l,t*h);return _.ED(n,[z])},0,null,b.Kb)},adjustSegmentDurations:function(){},getDuration:function(){return d},getLastSegmentEndTime:function(){return d}}},$N=function(a,b){var c=b.Rf,d=b.timeline;if(0===d.length)return[];for(var e=[],f={},g=0;g<d.length;f={hf:f.hf,me:f.me,af:f.af,kf:f.kf,bf:f.bf},
g++)f.me=g+b.Ac,f.kf=d[g].Nn+b.Cg,f.hf=a.O.id,f.af=a.bandwidth||null,f.bf=a.O.lb,e.push(new _.oj(f.me,d[g].start,d[g].end,function(h){return function(){var l=xN(c,h.hf,h.me,h.af,h.kf);return _.ED(h.bf,[l])}}(f),0,null,b.Kb));return e},VN=function(a){var b=yN(a,bO,"initialization");if(!b)return null;var c=a.O.id,d=a.bandwidth||null,e=a.O.lb;return new _.GD(function(){var f=xN(b,c,null,d,null);return _.ED(e,[f])},0,null)},gO=function(a,b){var c=RN(a,cO),d=dO(a);eO(a,d);var e=fO(a.Ca.duration,d.Ac,a.O.lb,
d),f=DN(a,e,b);EN(a,f);return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:f.Uc.bind(f),getSegmentReference:f.get.bind(f),adjustSegmentDurations:f.qd.bind(f),getDuration:f.getDuration.bind(f),initSegmentReference:c,getLastSegmentEndTime:function(){return _.GE(f)},Da:d.Kb}},cO=function(a){return a.ic},dO=function(a){var b=hO(a);a=AN(a,cO);var c=a.Ac;0===c&&(_.Dh("SegmentList@startNumber must be \x3e 0"),c=1);var d=0;a.Ka?d=a.Ka*(c-1):a.timeline&&0<a.timeline.length&&(d=a.timeline[0].start);
return{Ka:a.Ka,startTime:d,Ac:c,Kb:a.Kb,timeline:a.timeline,yc:b}},eO=function(a,b){if(!b.Ka&&!b.timeline&&1<b.yc.length)throw _.Dh(MM,"the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",a.O),new _.N(_.P,4,4002);if(!b.Ka&&!a.Ca.duration&&!b.timeline&&1===b.yc.length)throw _.Dh(MM,"the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",a.O),new _.N(_.P,4,4002);if(b.timeline&&0===b.timeline.length)throw _.Dh(MM,
"the SegmentList has an empty timeline.",a.O),new _.N(_.P,4,4002);},fO=function(a,b,c,d){var e=d.yc.length;d.timeline&&d.timeline.length!==d.yc.length&&(e=Math.min(d.timeline.length,d.yc.length),_.Dh("The number of items in the segment timeline and the number of","segment URLs do not match, truncating",d.yc.length,"to",e));for(var f=[],g=d.startTime,h={},l=0;l<e;h={ff:h.ff},l++){var m=d.yc[l];h.ff=_.ED(c,[m.Sl]);var n=void 0;n=null!=d.Ka?g+d.Ka:d.timeline?d.timeline[l].end:g+a;f.push(new _.oj(l+b,
g,n,function(p){return function(){return p.ff}}(h),m.start,m.end,d.Kb));g=n}return f},hO=function(a){return[a.O.ic,a.ua.ic,a.Ia.ic].filter(_.Qi).map(function(b){return _.Un(b,"SegmentURL")}).reduce(function(b,c){return 0<b.length?b:c}).map(function(b){b.getAttribute("indexRange")&&!a.Mf&&(a.Mf=!0,_.Dh("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate."));var c=b.getAttribute("media");b=
mN(b,"mediaRange",pN,{start:0,end:null});return{Sl:c,start:b.start,end:b.end}})},iO=function(a,b){this.g=a;this.f=b;this.a={clockSyncUri:void 0}},kO=function(a,b,c,d){var e,f;return _.I(function(g){switch(g.a){case 1:return e=_.Un(b,"UTCTiming"),_.D(g,2),_.y(g,jO(a,c,e),4);case 4:f=g.f;d.I=f;a.g.info("Clock synchronized. The difference between server and client clock was "+(f+" ms."));_.oh(g,3);break;case 2:_.E(g),a.g.warn("Failed to synchronize clocks. This content may not play on clients with bad clocks!");
case 3:return g["return"](d)}})},jO=function(a,b,c){c=c.map(function(e){return{scheme:e.getAttribute(WM),value:e.getAttribute(_.yg)}});var d=a.a.clockSyncUri;!c.length&&d&&(a.g.info("No UTCTiming elements found, falling back on clockSyncUri from config to synchronize clocks."),c.push({scheme:aN,value:d}));return 0===c.length?(a.g.warn(KM),Promise.reject(Error(KM))):gN(c,function(e){var f=e.scheme;e=e.value;switch(f){case aN:case "urn:mpeg:dash:utc:http-head:2012":return lO(a,b,e,"HEAD");case "urn:mpeg:dash:utc:http-xsdate:2014":case "urn:mpeg:dash:utc:http-iso:2014":case "urn:mpeg:dash:utc:http-xsdate:2012":case "urn:mpeg:dash:utc:http-iso:2012":return lO(a,
b,e,"GET");case "urn:mpeg:dash:utc:direct:2014":case "urn:mpeg:dash:utc:direct:2012":var g=Date.parse(e);return isNaN(g)?(a.g.warn("Invalid date for scheme "+f+", value: "+e),Promise.reject()):Promise.resolve(g-Date.now());case "urn:mpeg:dash:utc:http-ntp:2014":case "urn:mpeg:dash:utc:ntp:2014":case "urn:mpeg:dash:utc:sntp:2014":return a.g.warn("NTP UTCTiming scheme is not supported"),Promise.reject();default:return a.g.warn("Unrecognized scheme in UTCTiming element",f),Promise.reject()}})["catch"](function(){a.g.warn(IM);
return Promise.reject(Error(IM))})},lO=function(a,b,c,d){var e,f,g,h;return _.I(function(l){if(1==l.a)return e=_.ED(b,[c]),_.y(l,a.f(e,d),2);f=l.f;if("HEAD"===d){if(!f.headers||!f.headers.date)throw a.g.warn("UTC timing response is missing","expected date header"),Error("Date HTTP header missing.");g=f.headers.date}else g=_.R.aa(f.data);h=Date.parse(g);if(isNaN(h))throw a.g.warn("Unable to parse date from UTC timing response"),Error("Date value invalid.");return l["return"](h-Date.now())})},nO=function(a,
b){return a.find(function(c){return mO.get(c.Xb)===b})},pO=function(a){var b=kN(a.node,ZM,"pro");if(!b)return oO.warn(JM,a),null;a=_.Lj(b.textContent);a=_.io(a);a=_.ao(a.a);return{keyId:null,Xb:cN,node:document.createElement("null"),init:[{initData:_.sD(a),initDataType:_.rd,keyId:null}]}},qO=function(a,b){b=void 0===b?"4.0.0.0":b;var c=kN(a.node,$M,"pssh");if(!c)return _.Dh("Missing \x3ccenc:pssh/\x3e node in ContentProtection element",a),null;c=_.Lj(c.textContent);c=_.bo(c);return c?(c=_.tD(b,c.a))?
{keyId:null,Xb:bN,node:document.createElement("null"),init:[{initData:_.sD(c),initDataType:_.rd,keyId:null}]}:null:(_.Dh("Unable to parse WV PSSH data. Can not create PR data!"),null)},rO=function(a,b){var c=kN(a.node,ZM,"pro");if(!c)return _.Dh(JM,a),null;c=_.Lj(c.textContent);c=_.io(c);return c.version!==b&&(_.Ih("Parsing from "+c.version+" to "+b+"."),c=_.uD(c,b))?{keyId:null,Xb:bN,node:document.createElement("null"),init:[{initData:_.sD(c),initDataType:_.rd,keyId:null}]}:null},uO=function(a,b,
c,d){var e=sO(a),f=null;a=[];var g=[],h=nO(e,_.Pd),l=nO(e,_.Nd);if(l&&d){var m=rO(l,d);m&&(e[e.indexOf(l)]=m)}l&&!h&&(m=pO(l))&&e.push(m);h&&!l&&(d=qO(h,d||void 0))&&e.push(d);d=new Set(e.map(function(n){return n.keyId}));d["delete"](null);if(1<d.size)throw new _.N(_.P,4,4010);b||(g=e.filter(function(n){return"urn:mpeg:dash:mp4protection:2011"===n.Xb?(f=n.init||f,!1):!0}),g.length&&(a=tO(f,g,c),0===a.length&&(a=[_.FD(_.Te,f,c)])));if(e.length&&(b||!g.length))for(a=[],b=_.w(mO.values()),e=b.next();!e.done;e=
b.next())e=e.value,e!==_.bf&&a.push(_.FD(e,f,c));if(c=Array.from(d)[0]||null)for(b=_.w(a),e=b.next();!e.done;e=b.next())for(e=_.w(e.value.initData),g=e.next();!g.done;g=e.next())g.value.keyId=c;return{Dd:c,ro:f,drmInfos:a,zh:!0}},vO=function(a,b,c,d,e){var f=uO(a,c,d,e);if(b.zh){a=1===b.drmInfos.length&&!b.drmInfos[0].keySystem;c=0===f.drmInfos.length;if(0===b.drmInfos.length||a&&!c)b.drmInfos=f.drmInfos;b.Dd=f.Dd||b.Dd;b.zh=!1}else if(0<f.drmInfos.length&&(b.drmInfos=b.drmInfos.filter(function(g){return f.drmInfos.some(function(h){return h.keySystem===
g.keySystem})}),0===b.drmInfos.length))throw new _.N(_.P,4,4008);return f.Dd||b.Dd},wO=function(a){a=jN(a.node,"https://dashif.org/CPS","Laurl").map(function(b){return b.textContent}).filter(Boolean);return 0===a.length?null:1===a.length?a[0]:a[wN(a.length)]},tO=function(a,b,c){var d=[];b=_.w(b);for(var e=b.next();!e.done;e=b.next()){e=e.value;var f=mO.get(e.Xb);if(f){var g=_.FD(f,e.init||a,c);if(f=xO.get(f))g.licenseServerUri=f(e);d.push(g)}}return d},sO=function(a){var b=[];a=_.w(a);for(var c=a.next();!c.done;c=
a.next())(c=yO(c.value))&&b.push(c);return b},yO=function(a){var b=a.getAttribute(WM),c=lN(a,$M,"default_KID"),d=jN(a,$M,"pssh").map(_.Wn),e=kN(a,ZM,"pro");if(!b)return _.Jh("Missing required schemeIdUri attribute on","ContentProtection element",a),null;b=b.toLowerCase();if(c&&(c=c.replace(/-/g,"").toLowerCase(),c.includes(" ")))throw new _.N(_.P,4,4009);var f=[];try{if(f=d.map(function(l){return{initDataType:_.rd,initData:_.Lj(l),keyId:null}}),0===f.length&&e)try{var g=_.Lj(e.textContent),h=_.io(g);
f.push({initDataType:_.rd,initData:_.sD(h),keyId:null})}catch(l){_.Dh("Unable to parse ms:pro payload",l),f=[]}}catch(l){throw new _.N(_.P,4,4007);}return{node:a,Xb:b,keyId:c,init:0<f.length?f:null}},zO=function(){var a=this;this.D=this.a=null;this.l=[];this.f=null;this.G=[];this.w=1;this.H={};this.j=0;this.I=new _.dE(5);this.A=new _.pl(function(){a.Vb()});this.o=new _.jk;this.h=new Map;this.g=new _.K("clpp.dash.DashParser");this.B=null;this.J=new iO(this.g,function(b,c){var d=_.Yj(b,a.a.attemptParameters);
d.type=5;d.method=c;d=a.D.networkingEngine.fetch(d);_.kk(a.o,d);return d.U});this.C=new Map;this.K=!1},BO=function(a){var b,c,d,e,f,g,h,l,m;return _.I(function(n){if(1==n.a)return b=_.Yj(a.l,a.a.attemptParameters),b.type=1,c=a.D.networkingEngine,d=Date.now(),e=c.fetch(b),_.kk(a.o,e),_.y(n,e.U,2);if(3!=n.a){f=n.f;if(!a.D)return n["return"](0);f.uri&&!a.l.includes(f.uri)&&a.l.unshift(f.uri);g=null!=a.f;return _.y(n,AO(a,f.data,f.uri),3)}h=n.f;l=Date.now();m=(l-d)/1E3;_.eE(a.I,1,m);if(g&&a.D.onUpdate)a.D.onUpdate(h.manifest);
if(h.Ln){if(a.D.onTurnedStatic)a.D.onTurnedStatic();a.D.onEvent(new _.L(_.Re))}return n["return"](m)})},AO=function(a,b,c){var d,e,f,g;return _.I(function(h){if(1==h.a){d=uN(b,"MPD");if(!d)throw new _.N(_.P,4,4001,c);e=a.a.xlinkFailGracefully;f=BN(d,a.a.attemptParameters,e,c,a.D.networkingEngine);_.kk(a.o,f);return _.y(h,f.U,2)}g=h.f;return h["return"](CO(a,g,c))})},CO=function(a,b,c){var d,e,f,g,h,l,m,n,p,q,t,v,z,C,F,G;return _.I(function(B){if(1==B.a){d=[c];e=_.Un(b,"Location").map(_.Wn).filter(_.Qi);
0<e.length&&(f=_.ED(d,e),d=a.l=f);g=_.Un(b,"BaseURL").map(_.Wn);h=_.ED(d,g);l=b.getAttribute("type")||XM;a.j=mN(b,"minimumUpdatePeriod",oN,-1);l===XM&&0<=a.j&&(a.g.warn("Invalid manifest - a static manifest should not contain the `minimumUpdatePeriod` attribute. The attribute will be ignored."),a.j=-1,a.A.stop());m=mN(b,"maxSegmentDuration",oN);if(n=l===XM&&"dynamic"===a.B)a.g.info("MPD dynamic to static transition."),l="dynamic";p=l===XM;q="dynamic"===l;if(a.f)var H=a.f.presentationTimeline;else{H=
a.a.timeline||{};var O=mN(b,"suggestedPresentationDelay",oN),T=mN(b,"minBufferTime",oN,0);O=null!=a.a.suggestedPresentationDelay?a.a.suggestedPresentationDelay:a.a.lowLatencyMode?0:null!=O?O:3*T;T=mN(b,"availabilityStartTime",nN);H=new _.jE(H,T,O,p,!!a.a.autoCorrectDrift,!!a.a.lowLatencyMode);H=p?H:kO(a.J,b,h,H)}return _.y(B,H,2)}t=B.f;H=mN(b,"timeShiftBufferDepth",oN);v=q&&a.a.availabilityWindowOverride&&!isNaN(a.a.availabilityWindowOverride)?a.a.availabilityWindowOverride:null===H?Infinity:H;t.A=
v;if(!a.D)throw new _.N(_.P,7,7001);z={Ef:q,bi:null!=a.f,presentationTimeline:t,Ia:null,Ca:null,ua:null,O:null,bandwidth:0,Mf:!1,Hl:n,ug:null,Yd:null};C=DO(a,z,h,b);F=C.duration;G=C.periods;n&&(EO(G,z),t.C=!0);if(p||!n&&!C.sh)t.f=F||Infinity,F&&_.iE(t.a,0,F);_.rE(t,m||1);t.isLive();a.f||(a.f={presentationTimeline:t,periods:G,minBufferTime:0,cues:[]});a.f.cues=C.cues;a.B=l;return B["return"]({manifest:a.f,Ln:n})})},DO=function(a,b,c,d){var e=mN(d,"mediaPresentationDuration",oN),f=a.f?a.f.periods[a.f.periods.length-
1]||null:null,g=[],h=[],l=0;d=_.Un(d,"Period");for(var m=0;m<d.length;m++){var n=d[m];l=mN(n,_.bg,oN,l);var p=mN(n,QM,oN),q=null;if(m!==d.length-1){var t=mN(d[m+1],_.bg,oN);null!=t&&(q=t-l)}else null!=e&&(q=e-l);t=_.Cv;q&&p&&Math.abs(q-p)>t&&a.g.warn("There is a gap/overlap between Periods",n);null==q&&(q=p);n=FO(a,b,c,{start:l,duration:q,node:n,Xh:null==q||m===d.length-1});p=n.Ia;h.push(p);g=g.concat(n.cues);a.G.includes(p.id)||(a.G.push(p.id),a.f&&(a.D.filterNewPeriod(p),a.f.periods.push(p)));if(null==
q){m!==d.length-1&&a.g.warn("Skipping Period",m+1,"and any subsequent Periods:","Period",m+1,"does not have a valid start time.",h[m+1]);l=null;break}l+=q}null==a.f&&a.D.filterAllPeriods(h);f&&(b=h.find(function(v){return v.id===f.id}))&&(f.endTime=b.endTime);g=GO(a,g);return null!=e?(l!==e&&a.g.warn("@mediaPresentationDuration does not match the total duration of ","all Periods."),{periods:h,duration:e,sh:!1,cues:g}):{periods:h,duration:l,sh:!0,cues:g}},GO=function(a,b){var c=new Set(b.map(FN));
a.h.forEach(function(d,e){c.has(e)||a.h["delete"](e)});b.forEach(function(d){var e=FN(d);a.h.has(e)||a.h.set(e,d)});return Array.from(a.h.values())},FO=function(a,b,c,d){b.Ia=HO(a,d.node,null,c);b.Ca=d;c=b.Ia.id||"__clpp_period_"+d.start;b.Ia.id||(a.g.info("No Period ID given for Period with start time "+d.start+(",  Assigning a default: "+c+".")),b.Ia.id=c);var e=_.Un(d.node,"EventStream").flatMap(function(t){return IO(a,d.start,d.duration,t)}),f=_.Un(d.node,_.ka).map(function(t){return JO(a,b,t)}).filter(_.Qi);
if(b.Ef){for(var g=[],h=_.w(f),l=h.next();!l.done;l=h.next()){l=_.w(l.value.mn);for(var m=l.next();!m.done;m=l.next())g.push(m.value)}if(g.length!==(new Set(g)).size)throw new _.N(_.P,4,4018);}g=f.filter(function(t){return!t.Ag});h=f.filter(function(t){return t.Ag});h=_.w(h);for(l=h.next();!l.done;l=h.next()){m=l.value;m.streams.forEach(function(t){t.trickPlay=!0});l=m.streams[0];m=m.Ag;for(var n=_.w(g),p=n.next();!p.done;p=n.next())if(p=p.value,m.includes(p.id)){p=_.w(p.streams);for(var q=p.next();!q.done;q=
p.next())q.value.trickModeVideo=l}}h=KO(f,_.r);l=KO(g,_.$c);if(!h.length&&!l.length)throw new _.N(_.P,4,4004);l.length||(l=[null]);h.length||(h=[null]);f=[];l=_.w(l);for(m=l.next();!m.done;m=l.next())for(m=m.value,n=_.w(h),p=n.next();!p.done;p=n.next())LO(a,m,p.value,f);l=_.ah(KO(g,_.Q)).concat(_.ah(KO(g,_.ig)));h=[];l=_.w(l);for(m=l.next();!m.done;m=l.next())h.push.apply(h,m.value.streams);m=KO(g,_.ve);l=[];m=_.w(m);for(n=m.next();!n.done;n=m.next())l.push.apply(l,n.value.streams);g=MO(d,g);return{Ia:{id:c,
configurationId:a.D.configurationId,startTime:d.start,endTime:g,textStreams:h,thumbStreams:l,variants:f},cues:e}},MO=function(a,b){if(null!==a.duration)return a.start+a.duration;if(0<b.length){var c=b.filter(function(d){return 0<d.streams.length}).map(function(d){return d.streams}).flat().filter(function(d){return d.getLastSegmentEndTime}).map(function(d){return d.getLastSegmentEndTime()});return 0<c.length?a.start+Math.min.apply(Math,_.ah(c)):null}return null},KO=function(a,b){return a.filter(function(c){return c.contentType===
b})},LO=function(a,b,c,d){var e;if(b||c)if(b&&c){if(_.pp(b.drmInfos,c.drmInfos)){var f=_.op(b.drmInfos,c.drmInfos),g=_.w(b.streams);for(e=g.next();!e.done;e=g.next()){var h=e.value,l=_.w(c.streams);for(e=l.next();!e.done;e=l.next()){var m=e.value;e=(m.bandwidth||0)+(h.bandwidth||0);e={id:a.w++,language:b.language,primary:b.Qf||c.Qf,audio:h,video:m,bandwidth:e,drmInfos:f,allowedByApplication:!0,allowedByKeySystem:!0};d.push(e)}}}}else for(f=b||c,g=_.w(f.streams),e=g.next();!e.done;e=g.next())h=e.value,
e=h.bandwidth||0,e={id:a.w++,language:f.language||_.rg,primary:f.Qf,audio:b?h:null,video:c?h:null,bandwidth:e,drmInfos:f.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},d.push(e)},JO=function(a,b,c){b.ua=HO(a,c,b.Ia,null);var d=!1,e=_.Un(c,"Role"),f=e.map(function(B){return B.getAttribute(_.yg)}).filter(_.Qi),g=null,h=_.Un(c,"Label").map(function(B){return B.textContent}).filter(_.Qi);h&&0<h.length&&(g=h[h.length-1]);var l=void 0;(h=b.ua.contentType===_.Q)&&(l=_.ig);e=_.w(e);for(var m=e.next();!m.done;m=
e.next()){m=m.value;var n=m.getAttribute(WM);if(null==n||"urn:mpeg:dash:role:2011"===n||"urn:mpeg:dash:role"===n)switch(m=m.getAttribute(_.yg),m){case _.Ie:d=!0;break;case _.nd:case _.ig:l=m;break;case "forced-subtitle":case "forced_subtitle":case _.pe:l=_.pe}}m=_.Un(c,HM);e=null;m=_.w(m);for(var p=m.next();!p.done;p=m.next()){p=p.value;n=p.getAttribute(WM);p=p.getAttribute(_.yg);if(n!==RM&&!NO.includes(n)||void 0===p)return null;n===RM&&(0===p.length&&(e=null),e=p.split(" "))}m=_.Un(c,"Accessibility");
var q=new Map;n=_.w(m);for(p=n.next();!p.done;p=n.next()){var t=p.value;p=t.getAttribute(WM);if("urn:scte:dash:cc:cea-608:2015"===p||"urn:scte:dash:cc:cea-708:2015"===p)if(p=1,t=t.getAttribute(_.yg),null!=t){t=_.w(t.split(";"));for(var v=t.next();!v.done;v=t.next()){var z=v.value,C=v=void 0;z.includes("\x3d")?(z=z.split("\x3d"),v=z[0].startsWith("CC")?z[0]:"CC"+z[0],C=z[1].split(",")[0].split(":").pop()):(v="CC"+p,p+=2,C=z);q.set(v,_.qj(C))}}else q.set("CC1",_.rg)}n=_.Un(c,GM);var F=uO(n,a.a.ignoreDrmInfo,
b.Ia.id,a.a.playreadyVersion||null),G=c.getAttribute("lang")||_.rg;n=_.qj(G);null==g&&(g=c.getAttribute("label"));p=_.Un(c,_.Sb);c=p.map(function(B){return OO(a,b,F,l,G,g,d,f,q,B)}).filter(_.Qi);if(0===c.length){if(h)return null;throw new _.N(_.P,4,4003);}if(!b.ua.contentType||b.ua.contentType===_.Rc)for(b.ua.contentType=PO(c[0].mimeType,c[0].codecs),h=_.w(c),t=h.next();!t.done;t=h.next())t.value.type=b.ua.contentType;h=_.w(c);for(t=h.next();!t.done;t=h.next())for(t=t.value,v=_.w(F.drmInfos),z=v.next();!z.done;z=
v.next())z=z.value,t.keyId&&!z.keyIds.includes(t.keyId)&&z.keyIds.push(t.keyId);c=QO(c,b.ua.contentType,m);h=p.map(function(B){return B.getAttribute("id")}).filter(_.Qi);return{id:b.ua.id||"__fake__"+a.w++,contentType:b.ua.contentType,language:n,originalLanguage:G,Qf:d,streams:c,drmInfos:F.drmInfos,Ag:e,mn:h}},QO=function(a,b,c){var d=b===_.ig?_.Q:b;b=c.map(function(f){return{scheme:f.getAttribute(WM)||"",id:f.getAttribute("id")||void 0,value:f.getAttribute(_.yg)||"",protocol:"DASH",type:d}});c=_.w(a);
for(var e=c.next();!e.done;e=c.next())e.value.accessibility=b;return a},OO=function(a,b,c,d,e,f,g,h,l,m){var n=_.qj(e);b.O=HO(a,m,b.ua,null);if(!RO(a,b.O))return a.g.warn("Skipping Representation",b.O),null;b.ug=b.Ia.id+" "+b.O.id;b.Yd=a.C.get(b.ug);b.bandwidth=mN(m,"bandwidth",rN)||0;var p=SO(a,b);if(!p)return null;a.C.set(b.ug,p.Da);var q=_.Un(m,GM);a=vO(q,c,a.a.ignoreDrmInfo,b.Ia.id,a.a.playreadyVersion||null);q=!1;_.Un(m,"SupplementalProperty").some(function(C){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"===
C.getAttribute(WM)&&"JOC"===C.getAttribute(_.yg)})&&(b.O.mimeType="audio/eac3-joc",q=!0);var t=void 0;if(b.O.contentType===_.ve){var v=(m=_.Vn(m,HM))&&m.getAttribute(WM);if(TO.includes(v||"")&&(m=_.vj(m.getAttribute(_.yg)||""))&&(p.horizontalTiles=m.Pd,p.verticalTiles=m.fe,b.ua.jc)){v=mN(b.ua.jc,QM,sN)||0;var z=mN(b.ua.jc,YM,sN)||1;(v/=z)&&(t=v/m.Hn)}}return{id:_.uK++,originalId:b.O.id,createSegmentIndex:p.createSegmentIndex,findSegmentPosition:p.findSegmentPosition,getSegmentReference:p.getSegmentReference,
initSegmentReference:p.initSegmentReference,adjustSegmentDurations:p.adjustSegmentDurations,getLastSegmentEndTime:p.getLastSegmentEndTime,getDuration:p.getDuration,segmentLookupStrategy:_.aD,mimeType:b.O.mimeType,codecs:b.O.codecs,frameRate:b.O.frameRate,bandwidth:b.bandwidth,width:b.O.width,height:b.O.height,kind:d,encrypted:0<c.drmInfos.length,keyId:a,language:n,originalLanguage:e,label:f,type:b.ua.contentType,primary:g,trickModeVideo:null,emsgSchemeIdUris:b.O.emsgSchemeIdUris,roles:h,channelsCount:b.O.Sf,
spatialAudio:q,closedCaptions:l,horizontalTiles:p.horizontalTiles,verticalTiles:p.verticalTiles,durationPerTile:t}},SO=function(a,b){var c=a.a.attemptParameters,d=b.O.contentType;d=d===_.Q||d===_.Rc;try{var e=function(h,l,m,n){var p,q;return _.I(function(t){if(1==t.a)return p=_.gE(h,l,m,c),p.type=2,_.y(t,n.fetch(p),2);q=t.f;return t["return"](q.data)})};if(b.O.ce)return UN(b,e);if(b.O.ic)return gO(b,a.H);if(b.O.jc)return aO(b,e,a.H,!!a.f);var f=b.O.lb,g=b.Ca.duration||0;d=function(){return g};return{createSegmentIndex:function(){return Promise.resolve()},
findSegmentPosition:function(h){return 0<=h&&h<g?1:null},getSegmentReference:function(h){return 1!==h?null:new _.oj(1,0,g,function(){return f},0,null,0)},adjustSegmentDurations:function(){},getDuration:d,getLastSegmentEndTime:d,verticalTiles:void 0,horizontalTiles:void 0,initSegmentReference:null,Da:0}}catch(h){if(d&&4002===h.code)return a.g.debug("Ignoring DASH_NO_SEGMENT_INFO error in a text stream",h),null;throw h;}},UO=function(a,b){0>a.j||a.A.ea(Math.max(3,a.j-b,_.fE(a.I)))},HO=function(a,b,
c,d){c=c||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,Sf:null};d=d||c.lb;var e=_.Un(b,"BaseURL").map(_.Wn),f=b.getAttribute("contentType")||c.contentType,g=b.getAttribute(_.Oe)||c.mimeType,h=b.getAttribute(_.Gd)||c.codecs,l=mN(b,"frameRate",tN)||c.frameRate,m=_.Un(b,"InbandEventStream"),n=c.emsgSchemeIdUris.slice();m=_.w(m);for(var p=m.next();!p.done;p=m.next())p=p.value.getAttribute(WM),n.includes(p)||n.push(p);m=_.Un(b,"AudioChannelConfiguration");a=VO(a,m)||c.Sf;
f||(f=PO(g,h));return{lb:_.ED(d,e),ce:_.Vn(b,"SegmentBase")||c.ce,ic:_.Vn(b,"SegmentList")||c.ic,jc:_.Vn(b,"SegmentTemplate")||c.jc,width:mN(b,_.Sg,sN)||c.width,height:mN(b,_.se,sN)||c.height,contentType:f,mimeType:g,codecs:h,frameRate:l,emsgSchemeIdUris:n,id:b.getAttribute("id"),Sf:a}},VO=function(a,b){for(var c=_.w(b),d=c.next();!d.done;d=c.next()){var e=d.value;if(d=e.getAttribute(WM))if(e=e.getAttribute(_.yg))switch(d){case "urn:mpeg:dash:outputChannelPositionList:2012":return e.trim().split(/ +/).length;
case "urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case "urn:dts:dash:audio_channel_configuration:2012":var f=parseInt(e,10);if(!f){a.g.warn(FM,d,e);continue}return f;case "tag:dolby.com,2014:dash:audio_channel_configuration:2011":case "urn:dolby:dash:audio_channel_configuration:2011":f=parseInt(e,16);if(!f){a.g.warn(FM,d,e);continue}for(c=0;f;)f&1&&++c,f>>=1;return c;default:a.g.warn("Unrecognized audio channel scheme:",d,e)}}return null},RO=function(a,b){var c=b.ce?1:0;c+=b.ic?1:0;c+=
b.jc?1:0;if(0===c){if(b.contentType===_.Q||b.contentType===_.Rc)return!0;a.g.warn("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',b);return!1}1!==c&&(a.g.warn("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",b),b.ce?(a.g.info("Using SegmentBase by default."),
b.ic=null):a.g.info("Using SegmentList by default."),b.jc=null);return!0},IO=function(a,b,c,d){var e=d.getAttribute(WM)||"",f=d.getAttribute(_.yg)||"",g=mN(d,YM,sN)||1,h=mN(d,VM,sN)||0,l=[],m={};d=_.w(_.Un(d,"Event"));for(var n=d.next();!n.done;m={Gc:m.Gc},n=d.next()){n=n.value;var p=mN(n,"presentationTime",sN)||0,q=mN(n,QM,sN)||0;p=b+p/g-h/g;q=p+q/g;null!=c&&(p=Math.min(p,b+c),q=Math.min(q,b+c));var t=_.sg;e.startsWith(_.ug)?t=_.ri:"urn:mpeg:dash:event:callback:2015"===e&&(t=_.Se);m.Gc={configurationId:a.D.configurationId,
schemeIdUri:e,value:f,startTime:p,endTime:q,id:n.getAttribute("id")||"",type:t,eventElement:n};m.Gc.type===_.Se&&(m.Gc.Pe=function(v){return function(){var z=v.Gc;z.eventElement&&(z=z.eventElement.getAttribute("messageData")||"")&&z.startsWith("http")&&(z=_.Yj(z),z.type=_.Xj,a.D.networkingEngine.fetch(z))}}(m));l.push(m.Gc)}return l},PO=function(a,b){return _.pF(_.kl(a,b))?_.Q:a.split("/")[0]},WO=function(a){var b=new Set;a.forEach(function(c){c.variants.forEach(function(d){d.audio&&b.add(d.audio);
d.video&&b.add(d.video)})});return Array.from(b)},EO=function(a,b){var c=WO(a).filter(function(d){return d.getLastSegmentEndTime}).map(function(d){return d.getLastSegmentEndTime()});0<c.length&&(c=Math.min.apply(Math,_.ah(c)),_.pE(b.presentationTimeline,c+b.Ca.start))},XO=function(){},TO=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"],NO=["urn:mpeg:mpegB:cicp:ColourPrimaries","urn:mpeg:mpegB:cicp:MatrixCoefficients","urn:mpeg:mpegB:cicp:TransferCharacteristics"];var KN=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];ON.prototype.parse=function(a,b,c,d){b=new IN(new DataView(b));if(440786851!==MN(b).id)throw _.Jh("Not an EBML element."),new _.N(_.P,3,3008);var e=MN(b);if(408125543!==e.id)throw _.Jh("Not a Segment element."),new _.N(_.P,3,3009);b=e.a.byteOffset;e=new IN(e.a);for(var f=null;_.Zm(e.a);){var g=MN(e);if(357149030===g.id){f=g;break}}if(!f)throw _.Jh("Not an Info element."),new _.N(_.P,3,3010);f=new IN(f.a);g=1E6;for(e=null;_.Zm(f.a);){var h=MN(f);if(2807729===h.id)g=NN(h);else if(17545===h.id)if(4===
h.a.byteLength)e=h.a.getFloat32(0);else if(8===h.a.byteLength)e=h.a.getFloat64(0);else throw new _.N(_.P,3,3003);}if(null==e)throw new _.N(_.P,3,3011);f=g/1E9;e*=f;a=MN(new IN(new DataView(a)));if(475249515!==a.id)throw _.Jh("Not a Cues element."),new _.N(_.P,3,3007);return QN(a,b,f,e,c,d)};var mO=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",_.bf).set(cN,_.Pd).set(bN,_.Nd).set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95",_.Nd).set("urn:uuid:94ce86fb-07ff-4f43-adb8-93d2fa968ca2",_.Kd).set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb",_.Id),xO=(new Map).set(_.Pd,function(a){var b=wO(a);return b?b:(a=kN(a.node,"urn:microsoft","laurl"))?a.getAttribute("licenseUrl")||"":""}).set(_.Nd,function(a){var b=wO(a);if(b)return b;a=kN(a.node,ZM,"pro");if(!a)return"";a=_.Lj(a.textContent);
return _.io(a).h||""}),oO=new _.K("clpp.dash.ContentProtection");_.u=zO.prototype;_.u.configure=function(a){this.a=a;this.J.a={clockSyncUri:a.clockSyncUri}};_.u.start=function(a,b){var c=this,d;return _.I(function(e){if(1==e.a)return c.l=[a],c.D=b,_.y(e,BO(c),2);d=e.f;c.D&&UO(c,d);if(!c.D)throw new _.N(_.P,7,7001);return e["return"](c.f)})};_.u.requestStop=function(){this.K=!0};_.u.stop=function(){this.a=this.D=null;this.l=[];this.f=null;this.G=[];this.H={};this.B=null;this.j=-1;this.A.stop();this.C.clear();this.h.clear();return this.o.destroy()};
_.u.update=function(){var a=this;BO(this)["catch"](function(b){if(a.D&&b)a.D.onError(b)})};_.u.setCurrentVariant=function(){};_.u.Vb=function(){var a=this,b,c,d;return _.I(function(e){switch(e.a){case 1:return a.g.debug(_.SC),b=0,_.D(e,2),_.y(e,BO(a),4);case 4:b=e.f;_.oh(e,3);break;case 2:if(c=_.E(e),a.D&&c.a&&(a.D.onError(c),d=c,d.severity===_.P))return e["return"]();case 3:if(!a.D)return e["return"]();if(!a.K){e.F(5);break}return _.y(e,a.stop(),6);case 6:return e["return"]();case 5:UO(a,b),_.A(e)}})};_.x(XO,_.tt);XO.prototype.f=function(){_.su.mpd=zO;_.qu[_.Tc]=zO};XO.prototype.a=function(){_.iF("mpd");_.jF(_.Tc)};XO.prototype.id=function(){return"dash"};_.J("clpp.dash.DashComponent",XO);};
if(typeof(module)!="undefined"&&module.exports){var x=require("./cl.core.js");_ = x._;(f.call(g,this));module.exports=g;}
else if (typeof(define)!="undefined"&&define.amd) {define(["./cl.core"], function(c){_=c._;(f.call(g,this));return g;});}
else{_=this.clpp._;(f.call(g,this));}
})();