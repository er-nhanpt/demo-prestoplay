(function(){var g={}; var _ = _ || {}
var f=function(window){var Lw=" The setting will be ignored.",Mw="VTT parser encountered an invalid VTT setting: ",Nw="application/x-subrip",Ow="text/srt",Pw='text/vtt; codecs\x3d"vtt"',Qw='text/vtt; codecs\x3d"wvtt"',Rw=function(a){_.Rj(a,/[ \t]+/gm)},Sw=function(a){return a.a===a.f.length?null:(a=_.Rj(a,/[^ \t\n]*/gm))?a[0]:null},Tw=function(){},Uw=function(a){var b="";for(a=a.split(/\n/);3<a.length;){for(var c=3;c<a.length;++c)a[2]+="\n"+a[c];a.splice(3,a.length-3)}if(3!==a.length)return"";c=0;!a[0].match(/\d+:\d+:\d+/)&&
a[1].match(/\d+:\d+:\d+/)&&(b+=a[0].match(/\w+/)+"\n",++c);if(a[c].match(/\d+:\d+:\d+/)){var d=a[1].match(/(\d+):(\d+):(\d+)(?:,(\d+))?\s*--?>\s*(\d+):(\d+):(\d+)(?:,(\d+))?/);if(d)b+=d[1]+":"+d[2]+":"+d[3]+"."+d[4]+" --\x3e ",b+=d[5]+":"+d[6]+":"+d[7]+"."+d[8]+"\n",++c;else return""}else return"";a[c]&&(b+=a[c]+"\n\n");return b},Vw=function(){},Ww=function(a){this.a=a},Yw=function(a,b,c){var d;if(d=/^align:(start|middle|center|end|left|right)$/.exec(b))b=d[1],"middle"===b?a.textAlign=_.Ci:a.textAlign=
_.wv[b.toUpperCase()];else if(d=/^vertical:(lr|rl)$/.exec(b))a.writingMode="lr"===d[1]?_.Ag:_.Bg;else if(d=/^size:([\d.]+)%$/.exec(b))a.size=Number(d[1]);else if(d=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(b))a.position=Number(d[1]),d[2]&&(b=d[2],a.positionAlign=b===_.Be||b===_.bg?_.Be:b===_.Ce||b===_.le?_.Ce:_.sd);else if(d=/^region:(.*)$/.exec(b)){if(b=Xw(c,d[1]))a.region=b}else{a:{if(c=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(b))a.lineInterpretation=1,a.line=
Number(c[1]),c[2]&&(a.lineAlign=_.xv[c[2].toUpperCase()]);else if(c=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(b))a.lineInterpretation=_.Ei,a.line=Number(c[1]),c[2]&&(a.lineAlign=_.xv[c[2].toUpperCase()]);else{a=!1;break a}a=!0}return a}return!0},Xw=function(a,b){var c=a.filter(function(d){return d.id===b});return c.length?c[0]:(_.Dh("VTT parser could not find a region with id: ",b," The region will be ignored."),null)},Zw=function(a){a=_.Rj(a,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g);if(null==
a)return null;var b=Number(a[2]),c=Number(a[3]);return 59<b||59<c?null:Number(a[4])/1E3+c+60*b+3600*(Number(a[1])||0)},$w=function(){Ww.apply(this,arguments)},ax=function(){this.a=null;this.g=new _.K("clpp.vtt.mp4")},cx=function(a,b,c){var d,e,f;(new _.gn).M("payl",_.kn(function(g){d=_.R.aa(g)})).M("iden",_.kn(function(g){e=_.R.aa(g)})).M("sttg",_.kn(function(g){f=_.R.aa(g)})).parse(a);return d?bx(d,e,f,b,c):null},bx=function(a,b,c,d,e){a=new _.Hi(d,e,a,_.Kg);b&&(a.id=b);if(c)for(b=new _.Qj(c),c=
Sw(b);c;)Yw(a,c,[])||_.Dh(Mw,c,Lw),Rw(b),c=Sw(b);return a},dx=function(){this.j=new Vw};Tw.prototype.a=function(a){a=_.R.aa(a);a=a.replace(/\r+/g,"");a=a.replace(/^\s+|\s+$/g,"");a=a.replace(/<[a-zA-Z\\/][^>]*>/g,"");var b=a.split("\n\n");a="";if(0<b.length){a+="WEBVTT\n\n";b=_.w(b);for(var c=b.next();!c.done;c=b.next())a+=Uw(c.value)}return _.R.$a(a)};Vw.prototype.create=function(){return new Tw};Vw.prototype.probe=function(a,b){return(a===Ow||a===Nw)&&b===_.lg};Ww.prototype.parseInit=function(){};
Ww.prototype.parseMedia=function(a,b){var c=_.R.aa(a);c=c.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");var d=c.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(d[0]))throw new _.N(_.P,2,2E3);c=b.periodStart;if(d[0].includes("X-TIMESTAMP-MAP")){var e=d[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),f=d[0].match(/MPEGTS:(\d+)/m);if(e&&f){c=Zw(new _.Qj(e[1]));if(null==c)throw new _.N(_.P,2,2E3);f=Number(f[1]);for(e=b.segmentStart;95443.7176888889<=e;)e-=95443.7176888889,f+=8589934592;c=b.periodStart+
f/9E4-c}}else this.a.streaming.relativeTextTimestamp&&null!==b.segmentStart&&(c=b.segmentStart);f=[];e=_.w(d);for(var g=e.next();!g.done;g=e.next()){var h=g.value;if(/^region/.test(h.toLowerCase())){h=new _.Qj(h.replace(/\n/g," "));g=new _.Ki;Sw(h);Rw(h);for(var l=Sw(h);l;){var m;a:{var n=g,p=l;if(m=/^id:(.*)$/.exec(p))n.id=m[1];else if(m=/^width:(\d{1,2}|100)%$/.exec(p))n.width=Number(m[1]);else if(m=/^lines:(\d+)$/.exec(p))n.height=Number(m[1]),n.heightUnits=2;else if(m=/^regionanchor:(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(p))n.regionAnchorX=
Number(m[1]),n.regionAnchorY=Number(m[2]);else if(m=/^viewportanchor:(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(p))n.viewportAnchorX=Number(m[1]),n.viewportAnchorY=Number(m[2]);else if(/^scroll:up$/.exec(p))n.scroll="up";else{m=!1;break a}m=!0}m||_.Dh("VTT parser encountered an invalid VTTRegion setting: ",l,Lw);Rw(h);l=Sw(h)}f.push(g)}}e=[];h=_.w(d);for(g=h.next();!g.done;g=h.next())if(g=g.value,/^style/.test(g.toLowerCase())){g=g.replace(/^style/i,"").replace(/\n/g," ");l=/[^{}]+{[^{}]*}/g;do(m=l.exec(g))&&
e.push(m[0]);while(m)}h=[];d=_.w(d);for(g=d.next();!g.done;g=d.next())if(g=g.value,g.includes("--\x3e")){p=g.split("\n");var q=c;if(1===p.length&&!p[0]||/^NOTE($|[ \t])/.test(p[0])||"STYLE"===p[0])g=null;else{g=null;p[0].includes("--\x3e")||(g=p[0],p.splice(0,1));l=new _.Qj(p[0]);m=Zw(l);var t=_.Rj(l,/[ \t]+--\x3e[ \t]+/g);n=Zw(l);if(null==m||null==t||null==n)throw new _.N(_.P,2,2001);m+=q;n+=q;p=p.slice(1).join("\n").trim();m=new _.Hi(m,n,p,_.Kg);g&&(m.id=g);Rw(l);for(n=Sw(l);n;)Yw(m,n,f)||_.Dh(Mw,
n,Lw),Rw(l),n=Sw(l);null!=g&&(m.id=g);g=m}g&&h.push(g)}return{cues:h,styles:e}};_.x($w,Ww);$w.prototype.parseMedia=function(a,b){return Ww.prototype.parseMedia.call(this,(new Tw).a(a),b)};ax.prototype.parseInit=function(a){var b=this,c=!1;(new _.gn).M(_.Qe,_.hn).M(_.og,_.hn).M(_.Le,_.hn).Y("mdhd",function(d){0===d.version?(d.reader.skip(4),d.reader.skip(4),b.a=_.W(d.reader),d.reader.skip(4)):(d.reader.skip(8),d.reader.skip(8),b.a=_.W(d.reader),d.reader.skip(8));d.reader.skip(4)}).M(_.Pe,_.hn).M(_.eg,_.hn).Y(_.gg,_.jn).M("wvtt",function(){c=!0}).parse(a);if(!this.a)throw new _.N(_.P,2,2008);if(!c)throw new _.N(_.P,2,2008);};
ax.prototype.parseMedia=function(a,b){if(!this.a)throw this.g.error("No init segment for MP4+VTT!"),new _.N(_.P,2,2008);var c=0,d=[],e,f=[],g=!1,h=!1,l=!1,m=null;(new _.gn).M("moof",_.hn).M("traf",_.hn).Y("tfdt",function(H){g=!0;c=0===H.version?_.W(H.reader):_.dn(H.reader)}).Y("tfhd",function(H){var O=H.flags;H=H.reader;H.skip(4);O&1&&H.skip(8);O&2&&H.skip(4);m=O&8?_.W(H):null}).Y("trun",function(H){h=!0;var O=H.version,T=H.flags;H=H.reader;var da=_.W(H);T&1&&H.skip(4);T&4&&H.skip(4);for(var aa=[],
ya=0;ya<da;ya++){var Va={duration:null,sampleSize:null,zg:null};T&256&&(Va.duration=_.W(H));T&512&&(Va.sampleSize=_.W(H));T&1024&&H.skip(4);T&2048&&(Va.zg=0===O?_.W(H):_.cn(H));aa.push(Va)}d=aa}).M(_.Je,_.kn(function(H){l=!0;e=H})).parse(a);if(!l&&!g&&!h)throw new _.N(_.P,2,2008);var n=c,p=new DataView(e.buffer,e.byteOffset,e.byteLength);p=new _.Ym(p,!1);for(var q=_.w(d),t=q.next();!t.done;t=q.next()){t=t.value;var v=t.duration||m,z=t.zg?c+t.zg:n;n=z+(v||0);var C=0;do{var F=_.W(p);C+=F;var G=_.W(p);
G=_.mn(G);var B=null;"vttc"===G?8<F&&(B=_.fn(p,F-8)):("vtte"!==G&&this.g.error("Unknown box "+G+"! Skipping!"),p.skip(F-8));v?B&&f.push(cx(B,b.periodStart+z/this.a,b.periodStart+n/this.a)):this.g.error("WVTT sample duration unknown, and no default found!")}while(t.sampleSize&&C<t.sampleSize)}return{cues:f.filter(_.Qi),styles:[]}};_.x(dx,_.tt);dx.prototype.f=function(){_.cv(_.lg,Ww);_.cv(Pw,Ww);_.cv(Qw,Ww);_.cv(_.Wc,ax);_.cv(Ow,$w);_.cv(Nw,$w);_.$k.push(this.j)};dx.prototype.a=function(){_.ev(_.lg);_.ev(Pw);_.ev(Qw);_.ev(_.Wc);_.ev(Ow);_.ev(Nw);_.bl(this.j)};dx.prototype.id=function(){return"subtitles-vtt"};_.J("clpp.vtt.VttComponent",dx);};
if(typeof(module)!="undefined"&&module.exports){var x=require("./cl.core.js");_ = x._;(f.call(g,this));module.exports=g;}
else if (typeof(define)!="undefined"&&define.amd) {define(["./cl.core"], function(c){_=c._;(f.call(g,this));return g;});}
else{_=this.clpp._;(f.call(g,this));}
})();